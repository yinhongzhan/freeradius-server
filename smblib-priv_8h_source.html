<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FreeRADIUS: /home/pjm3/freeradius-server/src/modules/rlm_smb/smblib-priv.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">FreeRADIUS
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_6054e169f0f58ec6883eae51771d7f33.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_4cc3e6fe4b61867fd806af76a262971e.html">modules</a>      </li>
      <li class="navelem"><a class="el" href="dir_906efc11c3130b27e9af48ed350f8551.html">rlm_smb</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">smblib-priv.h</div>  </div>
</div>
<div class="contents">
<a href="smblib-priv_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* UNIX SMBlib NetBIOS implementation</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">   Version 1.0</span>
<a name="l00004"></a>00004 <span class="comment">   SMBlib private Defines</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment">   Copyright (C) Richard Sharpe 1996</span>
<a name="l00007"></a>00007 <span class="comment">   Copyright 2006 The FreeRADIUS server project</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">*/</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="comment">/*</span>
<a name="l00012"></a>00012 <span class="comment">   This program is free software; you can redistribute it and/or modify</span>
<a name="l00013"></a>00013 <span class="comment">   it under the terms of the GNU General Public License as published by</span>
<a name="l00014"></a>00014 <span class="comment">   the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00015"></a>00015 <span class="comment">   (at your option) any later version.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">   This program is distributed in the hope that it will be useful,</span>
<a name="l00018"></a>00018 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00019"></a>00019 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00020"></a>00020 <span class="comment">   GNU General Public License for more details.</span>
<a name="l00021"></a>00021 <span class="comment"></span>
<a name="l00022"></a>00022 <span class="comment">   You should have received a copy of the GNU General Public License</span>
<a name="l00023"></a>00023 <span class="comment">   along with this program; if not, write to the Free Software</span>
<a name="l00024"></a>00024 <span class="comment">   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<a name="l00025"></a>00025 <span class="comment">*/</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;freeradius-devel/ident.h&gt;</span>
<a name="l00028"></a>00028 <a class="code" href="ident_8h.html#a5d3fd09f593830b6b9399c1e90e74dac">RCSIDH</a>(smblib_priv_h, <span class="stringliteral">&quot;$Id$&quot;</span>)
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;std-includes.h&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="smblib-common_8h.html">smblib-common.h</a>&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="smblib-priv_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">00033</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="rfcnb-priv_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>;
<a name="l00034"></a><a class="code" href="smblib-priv_8h.html#a1134b580f8da4de94ca6b1de4d37975e">00034</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   <a class="code" href="smblib-priv_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="byteorder_8h.html">byteorder.h</a>&quot;</span>     <span class="comment">/* Hmmm ... hot good */</span>
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="smblib-priv_8h.html#affe776513b24d84b39af8ab0930fef7f">00038</a> <span class="preprocessor">#define max(a,b) (a &lt; b ? b : a)</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span>
<a name="l00040"></a><a class="code" href="smblib-priv_8h.html#ab5faa996249bf621eb8212256553ae79">00040</a> <span class="preprocessor">#define SMB_DEF_IDF 0x424D53FF        </span><span class="comment">/* &quot;\377SMB&quot; */</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="comment">/* Core protocol commands */</span>
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="smblib-priv_8h.html#adc08e53208723ba214ad1709e9183656">00044</a> <span class="preprocessor">#define SMBmkdir      0x00   </span><span class="comment">/* create directory */</span>
<a name="l00045"></a><a class="code" href="smblib-priv_8h.html#ab90c102db76178fefb6b4be09030261a">00045</a> <span class="preprocessor">#define SMBrmdir      0x01   </span><span class="comment">/* delete directory */</span>
<a name="l00046"></a><a class="code" href="smblib-priv_8h.html#aad2e5bf3680b5f5da575b57f3643f096">00046</a> <span class="preprocessor">#define SMBopen       0x02   </span><span class="comment">/* open file */</span>
<a name="l00047"></a><a class="code" href="smblib-priv_8h.html#ad45b00d32d9bb851d5ed56065dcd98d8">00047</a> <span class="preprocessor">#define SMBcreate     0x03   </span><span class="comment">/* create file */</span>
<a name="l00048"></a><a class="code" href="smblib-priv_8h.html#a4305b05f4ea3266cf3b3e754e55eee5a">00048</a> <span class="preprocessor">#define SMBclose      0x04   </span><span class="comment">/* close file */</span>
<a name="l00049"></a><a class="code" href="smblib-priv_8h.html#a3a2b1e3e8dde109d0875a90dd4328a3f">00049</a> <span class="preprocessor">#define SMBflush      0x05   </span><span class="comment">/* flush file */</span>
<a name="l00050"></a><a class="code" href="smblib-priv_8h.html#af6d8944b360fb17228c1ec7279c7005c">00050</a> <span class="preprocessor">#define SMBunlink     0x06   </span><span class="comment">/* delete file */</span>
<a name="l00051"></a><a class="code" href="smblib-priv_8h.html#a7f32fa69c0ef48f53e672e608b41699c">00051</a> <span class="preprocessor">#define SMBmv         0x07   </span><span class="comment">/* rename file */</span>
<a name="l00052"></a><a class="code" href="smblib-priv_8h.html#ac57d076062361c6c09002afb9db32ab5">00052</a> <span class="preprocessor">#define SMBgetatr     0x08   </span><span class="comment">/* get file attributes */</span>
<a name="l00053"></a><a class="code" href="smblib-priv_8h.html#a96e29acddaa286bc9b7e7e85239b4eaa">00053</a> <span class="preprocessor">#define SMBsetatr     0x09   </span><span class="comment">/* set file attributes */</span>
<a name="l00054"></a><a class="code" href="smblib-priv_8h.html#a2eb70600db071a021cfe77efaa9be34b">00054</a> <span class="preprocessor">#define SMBread       0x0A   </span><span class="comment">/* read from file */</span>
<a name="l00055"></a><a class="code" href="smblib-priv_8h.html#ab883c668eee945d704435d324664450e">00055</a> <span class="preprocessor">#define SMBwrite      0x0B   </span><span class="comment">/* write to file */</span>
<a name="l00056"></a><a class="code" href="smblib-priv_8h.html#afb9dbb949e1b84f9c5dc7250020686a4">00056</a> <span class="preprocessor">#define SMBlock       0x0C   </span><span class="comment">/* lock byte range */</span>
<a name="l00057"></a><a class="code" href="smblib-priv_8h.html#a3ef877214971cb177988c2e8db8a70d5">00057</a> <span class="preprocessor">#define SMBunlock     0x0D   </span><span class="comment">/* unlock byte range */</span>
<a name="l00058"></a><a class="code" href="smblib-priv_8h.html#ab41c93ef180ea961b00552891710e7a4">00058</a> <span class="preprocessor">#define SMBctemp      0x0E   </span><span class="comment">/* create temporary file */</span>
<a name="l00059"></a><a class="code" href="smblib-priv_8h.html#aa4d478554f5173bfc0a1171955acd607">00059</a> <span class="preprocessor">#define SMBmknew      0x0F   </span><span class="comment">/* make new file */</span>
<a name="l00060"></a><a class="code" href="smblib-priv_8h.html#adfccc103a5c3610bc1c1fe6c0edc850c">00060</a> <span class="preprocessor">#define SMBchkpth     0x10   </span><span class="comment">/* check directory path */</span>
<a name="l00061"></a><a class="code" href="smblib-priv_8h.html#ad3c19a7aee9c98f083b84fb08ede90f8">00061</a> <span class="preprocessor">#define SMBexit       0x11   </span><span class="comment">/* process exit */</span>
<a name="l00062"></a><a class="code" href="smblib-priv_8h.html#aa77677948f3a9b70934ae06f4352407f">00062</a> <span class="preprocessor">#define SMBlseek      0x12   </span><span class="comment">/* seek */</span>
<a name="l00063"></a><a class="code" href="smblib-priv_8h.html#a95260114614c1acf60835f77b6e94566">00063</a> <span class="preprocessor">#define SMBtcon       0x70   </span><span class="comment">/* tree connect */</span>
<a name="l00064"></a><a class="code" href="smblib-priv_8h.html#ae09d83b1690fd8dfaf3c68263f771533">00064</a> <span class="preprocessor">#define SMBtdis       0x71   </span><span class="comment">/* tree disconnect */</span>
<a name="l00065"></a><a class="code" href="smblib-priv_8h.html#a61338c155b32f1c211821637b7e52f77">00065</a> <span class="preprocessor">#define SMBnegprot    0x72   </span><span class="comment">/* negotiate protocol */</span>
<a name="l00066"></a><a class="code" href="smblib-priv_8h.html#ae5b6a74bb67987f42b11c455a14f269d">00066</a> <span class="preprocessor">#define SMBdskattr    0x80   </span><span class="comment">/* get disk attributes */</span>
<a name="l00067"></a><a class="code" href="smblib-priv_8h.html#a6f8d4ef1d69b852cea9b7bc21a8bc265">00067</a> <span class="preprocessor">#define SMBsearch     0x81   </span><span class="comment">/* search directory */</span>
<a name="l00068"></a><a class="code" href="smblib-priv_8h.html#aaf97da870dc53d53ae6c712c24c62699">00068</a> <span class="preprocessor">#define SMBsplopen    0xC0   </span><span class="comment">/* open print spool file */</span>
<a name="l00069"></a><a class="code" href="smblib-priv_8h.html#a3b6cbbd8cfe0c412bd5a0329df372957">00069</a> <span class="preprocessor">#define SMBsplwr      0xC1   </span><span class="comment">/* write to print spool file */</span>
<a name="l00070"></a><a class="code" href="smblib-priv_8h.html#a3bf8ccafe1249583edc32c497737d954">00070</a> <span class="preprocessor">#define SMBsplclose   0xC2   </span><span class="comment">/* close print spool file */</span>
<a name="l00071"></a><a class="code" href="smblib-priv_8h.html#a0619ebe906fe82477509a3a61e95dfdc">00071</a> <span class="preprocessor">#define SMBsplretq    0xC3   </span><span class="comment">/* return print queue */</span>
<a name="l00072"></a><a class="code" href="smblib-priv_8h.html#ab0c8172484715a4936fb1ef0f8669a85">00072</a> <span class="preprocessor">#define SMBsends      0xD0   </span><span class="comment">/* send single block message */</span>
<a name="l00073"></a><a class="code" href="smblib-priv_8h.html#a559f0717c96ba29ce1a03f145a965954">00073</a> <span class="preprocessor">#define SMBsendb      0xD1   </span><span class="comment">/* send broadcast message */</span>
<a name="l00074"></a><a class="code" href="smblib-priv_8h.html#a71f199cb1b31f9835caf2add52716735">00074</a> <span class="preprocessor">#define SMBfwdname    0xD2   </span><span class="comment">/* forward user name */</span>
<a name="l00075"></a><a class="code" href="smblib-priv_8h.html#a9a7d530198a9684bd4ec037db7244521">00075</a> <span class="preprocessor">#define SMBcancelf    0xD3   </span><span class="comment">/* cancel forward */</span>
<a name="l00076"></a><a class="code" href="smblib-priv_8h.html#aee40e7b3bbcddecbd7c1cf1c10ef04d3">00076</a> <span class="preprocessor">#define SMBgetmac     0xD4   </span><span class="comment">/* get machine name */</span>
<a name="l00077"></a><a class="code" href="smblib-priv_8h.html#a1ed576d9fbc70c2c33b452555d0eaf88">00077</a> <span class="preprocessor">#define SMBsendstrt   0xD5   </span><span class="comment">/* send start of multi-block message */</span>
<a name="l00078"></a><a class="code" href="smblib-priv_8h.html#a10e2572ff5f1f1abc2999efaa1dc872f">00078</a> <span class="preprocessor">#define SMBsendend    0xD6   </span><span class="comment">/* send end of multi-block message */</span>
<a name="l00079"></a><a class="code" href="smblib-priv_8h.html#acf4c9d52e3952acd6d2c95300a85bdbd">00079</a> <span class="preprocessor">#define SMBsendtxt    0xD7   </span><span class="comment">/* send text of multi-block message */</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">/* CorePlus protocol                                        */</span>
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="smblib-priv_8h.html#ad16c0aefb617786cc789c6c29d9f4660">00083</a> <span class="preprocessor">#define SMBlockread   0x13  </span><span class="comment">/* Lock a range and read it */</span>
<a name="l00084"></a><a class="code" href="smblib-priv_8h.html#a58f860953fa952efefa872b7d65bca86">00084</a> <span class="preprocessor">#define SMBwriteunlock 0x14 </span><span class="comment">/* Unlock a range and then write */</span>
<a name="l00085"></a><a class="code" href="smblib-priv_8h.html#aa7995bcf32efc0ae270b5f5176ed1f9e">00085</a> <span class="preprocessor">#define SMBreadbraw   0x1a  </span><span class="comment">/* read a block of data without smb header ohead*/</span>
<a name="l00086"></a><a class="code" href="smblib-priv_8h.html#a46bc4044ad9b8052e37699b724120c23">00086</a> <span class="preprocessor">#define SMBwritebraw  0x1d  </span><span class="comment">/* write a block of data without smb header ohead*/</span>
<a name="l00087"></a><a class="code" href="smblib-priv_8h.html#ac6540d8d747658eb6b969f610f10f96e">00087</a> <span class="preprocessor">#define SMBwritec     0x20  </span><span class="comment">/* secondary write request */</span>
<a name="l00088"></a><a class="code" href="smblib-priv_8h.html#a873a6bb57cea46958d974a271d47ed15">00088</a> <span class="preprocessor">#define SMBwriteclose 0x2c  </span><span class="comment">/* write a file and then close it */</span>
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="comment">/* DOS Extended Protocol                                    */</span>
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="smblib-priv_8h.html#acbeabc7a57fa0e40caa6045fa65f6114">00092</a> <span class="preprocessor">#define SMBreadBraw      0x1A   </span><span class="comment">/* read block raw */</span>
<a name="l00093"></a><a class="code" href="smblib-priv_8h.html#aca75c05b9d3f7d5af1451151cfda3157">00093</a> <span class="preprocessor">#define SMBreadBmpx      0x1B   </span><span class="comment">/* read block multiplexed */</span>
<a name="l00094"></a><a class="code" href="smblib-priv_8h.html#a502df82efff5de9753f9d8620ea03efb">00094</a> <span class="preprocessor">#define SMBreadBs        0x1C   </span><span class="comment">/* read block (secondary response) */</span>
<a name="l00095"></a><a class="code" href="smblib-priv_8h.html#a353c1f0a2b30862a9f22040fe4d395a5">00095</a> <span class="preprocessor">#define SMBwriteBraw     0x1D   </span><span class="comment">/* write block raw */</span>
<a name="l00096"></a><a class="code" href="smblib-priv_8h.html#a0704a07c941a339863388bf639034589">00096</a> <span class="preprocessor">#define SMBwriteBmpx     0x1E   </span><span class="comment">/* write block multiplexed */</span>
<a name="l00097"></a><a class="code" href="smblib-priv_8h.html#ab90952ee4c2263e3ac88972331c8b410">00097</a> <span class="preprocessor">#define SMBwriteBs       0x1F   </span><span class="comment">/* write block (secondary request) */</span>
<a name="l00098"></a><a class="code" href="smblib-priv_8h.html#add6a9fd860af23207ebefb87a5565732">00098</a> <span class="preprocessor">#define SMBwriteC        0x20   </span><span class="comment">/* write complete response */</span>
<a name="l00099"></a><a class="code" href="smblib-priv_8h.html#a476545cd780efbeadbd531ab58579a2a">00099</a> <span class="preprocessor">#define SMBsetattrE      0x22   </span><span class="comment">/* set file attributes expanded */</span>
<a name="l00100"></a><a class="code" href="smblib-priv_8h.html#acbc67281b075fb9b6356110c8b96d50c">00100</a> <span class="preprocessor">#define SMBgetattrE      0x23   </span><span class="comment">/* get file attributes expanded */</span>
<a name="l00101"></a><a class="code" href="smblib-priv_8h.html#a481cad8509658735c194359503c395d4">00101</a> <span class="preprocessor">#define SMBlockingX      0x24   </span><span class="comment">/* lock/unlock byte ranges and X */</span>
<a name="l00102"></a><a class="code" href="smblib-priv_8h.html#a884094eb22ebeb75922fac948fcf6776">00102</a> <span class="preprocessor">#define SMBtrans         0x25   </span><span class="comment">/* transaction - name, bytes in/out */</span>
<a name="l00103"></a><a class="code" href="smblib-priv_8h.html#a142d5c323e7c7386babef3394cc930a9">00103</a> <span class="preprocessor">#define SMBtranss        0x26   </span><span class="comment">/* transaction (secondary request/response) */</span>
<a name="l00104"></a><a class="code" href="smblib-priv_8h.html#a73267b5b077b0fc03b86490247625947">00104</a> <span class="preprocessor">#define SMBioctl         0x27   </span><span class="comment">/* IOCTL */</span>
<a name="l00105"></a><a class="code" href="smblib-priv_8h.html#a0431df00d25720f4e48ffa5e17496b3f">00105</a> <span class="preprocessor">#define SMBioctls        0x28   </span><span class="comment">/* IOCTL  (secondary request/response) */</span>
<a name="l00106"></a><a class="code" href="smblib-priv_8h.html#aadd2b751a0a91bd60045da214b332ca0">00106</a> <span class="preprocessor">#define SMBcopy          0x29   </span><span class="comment">/* copy */</span>
<a name="l00107"></a><a class="code" href="smblib-priv_8h.html#a9126d9e2c37b936e18d8ffc15f6eabed">00107</a> <span class="preprocessor">#define SMBmove          0x2A   </span><span class="comment">/* move */</span>
<a name="l00108"></a><a class="code" href="smblib-priv_8h.html#a02f5334e34dcee9a69d88cf7c292a32b">00108</a> <span class="preprocessor">#define SMBecho          0x2B   </span><span class="comment">/* echo */</span>
<a name="l00109"></a><a class="code" href="smblib-priv_8h.html#a6317beae5620880d42d9ffffc57ade4e">00109</a> <span class="preprocessor">#define SMBopenX         0x2D   </span><span class="comment">/* open and X */</span>
<a name="l00110"></a><a class="code" href="smblib-priv_8h.html#a8c85ef231f60034684aa66371115c2be">00110</a> <span class="preprocessor">#define SMBreadX         0x2E   </span><span class="comment">/* read and X */</span>
<a name="l00111"></a><a class="code" href="smblib-priv_8h.html#ace67f41d94994b2afe0b5ad61572c5a0">00111</a> <span class="preprocessor">#define SMBwriteX        0x2F   </span><span class="comment">/* write and X */</span>
<a name="l00112"></a><a class="code" href="smblib-priv_8h.html#afafd8bfcb5f576fc3eecbcb5a69ea702">00112</a> <span class="preprocessor">#define SMBsesssetupX    0x73   </span><span class="comment">/* Session Set Up &amp; X (including User Logon) */</span>
<a name="l00113"></a><a class="code" href="smblib-priv_8h.html#a36de19408b8793cb2fe6c11f1a2dbc9c">00113</a> <span class="preprocessor">#define SMBtconX         0x75   </span><span class="comment">/* tree connect and X */</span>
<a name="l00114"></a><a class="code" href="smblib-priv_8h.html#a7dc8ad401827ec68395cbd9fd560349b">00114</a> <span class="preprocessor">#define SMBffirst        0x82   </span><span class="comment">/* find first */</span>
<a name="l00115"></a><a class="code" href="smblib-priv_8h.html#ab6a3e2d07f69618670758d96fd740aa1">00115</a> <span class="preprocessor">#define SMBfunique       0x83   </span><span class="comment">/* find unique */</span>
<a name="l00116"></a><a class="code" href="smblib-priv_8h.html#a452d42f741bc1389a1622b10615275c9">00116</a> <span class="preprocessor">#define SMBfclose        0x84   </span><span class="comment">/* find close */</span>
<a name="l00117"></a><a class="code" href="smblib-priv_8h.html#af3764b3747a92752d664eb4a07f0d0e7">00117</a> <span class="preprocessor">#define SMBinvalid       0xFE   </span><span class="comment">/* invalid command */</span>
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 <span class="comment">/* Any more ? */</span>
<a name="l00120"></a>00120 
<a name="l00121"></a><a class="code" href="smblib-priv_8h.html#a3763b3972a2686d91d7cb323ae946c6d">00121</a> <span class="preprocessor">#define SMBdatablockID     0x01  </span><span class="comment">/* A data block identifier */</span>
<a name="l00122"></a><a class="code" href="smblib-priv_8h.html#aca57ddaeaa2f3f62e1e4fb95788d1de5">00122</a> <span class="preprocessor">#define SMBdialectID       0x02  </span><span class="comment">/* A dialect id            */</span>
<a name="l00123"></a><a class="code" href="smblib-priv_8h.html#acc6690823fa6afc0cdc49bad47c70af1">00123</a> <span class="preprocessor">#define SMBpathnameID      0x03  </span><span class="comment">/* A pathname ID           */</span>
<a name="l00124"></a><a class="code" href="smblib-priv_8h.html#a5ea3474c6bf3dc779df6566eeff99176">00124</a> <span class="preprocessor">#define SMBasciiID         0x04  </span><span class="comment">/* An ascii string ID      */</span>
<a name="l00125"></a><a class="code" href="smblib-priv_8h.html#a71d6f841032011398c8f7ffc4d5b79f3">00125</a> <span class="preprocessor">#define SMBvariableblockID 0x05  </span><span class="comment">/* A variable block ID     */</span>
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="comment">/* some other defines we need */</span>
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="comment">/* Flags defines ... */</span>
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="smblib-priv_8h.html#a41c716649896a8f950ecaee79049b69f">00131</a> <span class="preprocessor">#define SMB_FLG2_NON_DOS    0x01 </span><span class="comment">/* We know non dos names             */</span>
<a name="l00132"></a><a class="code" href="smblib-priv_8h.html#a85c9de96bcaf203953a7db75531a78c7">00132</a> <span class="preprocessor">#define SMB_FLG2_EXT_ATR    0x02 </span><span class="comment">/* We know about Extended Attributes */</span>
<a name="l00133"></a><a class="code" href="smblib-priv_8h.html#a5eb3f13a5e3c6999fa6e2541d8f4b6fe">00133</a> <span class="preprocessor">#define SMB_FLG2_LNG_NAM    0x04 </span><span class="comment">/* Long names ?                      */</span>
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="smblib-priv_8h.html#a197942eefa7db30960ae396d68339b97">00135</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="smblib-priv_8h.html#a197942eefa7db30960ae396d68339b97">WORD</a>;
<a name="l00136"></a><a class="code" href="smblib-priv_8h.html#aefbb6ca39ebcf009709e607d159766d5">00136</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="smblib-priv_8h.html#aefbb6ca39ebcf009709e607d159766d5">UWORD</a>;
<a name="l00137"></a><a class="code" href="smblib-priv_8h.html#abe09d1bea023be6a07cbadde8e955435">00137</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="smblib-priv_8h.html#abe09d1bea023be6a07cbadde8e955435">ULONG</a>;
<a name="l00138"></a><a class="code" href="smblib-priv_8h.html#a4ae1dab0fb4b072a66584546209e7d58">00138</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="smblib-priv_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>;
<a name="l00139"></a><a class="code" href="smblib-priv_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">00139</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="smblib-priv_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 <span class="comment">/* Some macros to allow access to actual packet data so that we */</span>
<a name="l00142"></a>00142 <span class="comment">/* can change the underlying representation of packets.         */</span>
<a name="l00143"></a>00143 <span class="comment">/*                                                              */</span>
<a name="l00144"></a>00144 <span class="comment">/* The current formats vying for attention are a fragment       */</span>
<a name="l00145"></a>00145 <span class="comment">/* approach where the SMB header is a fragment linked to the    */</span>
<a name="l00146"></a>00146 <span class="comment">/* data portion with the transport protocol (rfcnb or whatever) */</span>
<a name="l00147"></a>00147 <span class="comment">/* being linked on the front.                                   */</span>
<a name="l00148"></a>00148 <span class="comment">/*                                                              */</span>
<a name="l00149"></a>00149 <span class="comment">/* The other approach is where the whole packet is one array    */</span>
<a name="l00150"></a>00150 <span class="comment">/* of bytes with space allowed on the front for the packet      */</span>
<a name="l00151"></a>00151 <span class="comment">/* headers.                                                     */</span>
<a name="l00152"></a>00152 
<a name="l00153"></a><a class="code" href="smblib-priv_8h.html#a25ff4fea4404e103ff0f2209a1c813e4">00153</a> <span class="preprocessor">#define SMB_Hdr(p) (char *)(p -&gt; data)</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span>
<a name="l00155"></a>00155 <span class="comment">/* SMB Hdr def for File Sharing Protocol? From MS and Intel,    */</span>
<a name="l00156"></a>00156 <span class="comment">/* Intel PN 138446 Doc Version 2.0, Nov 7, 1988. This def also  */</span>
<a name="l00157"></a>00157 <span class="comment">/* applies to LANMAN1.0 as well as the Core Protocol            */</span>
<a name="l00158"></a>00158 <span class="comment">/* The spec states that wct and bcc must be present, even if 0  */</span>
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="comment">/* We define these as offsets into a char SMB[] array for the   */</span>
<a name="l00161"></a>00161 <span class="comment">/* sake of portability                                          */</span>
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">/* NOTE!. Some of the lenght defines, SMB_&lt;protreq&gt;_len do not include */</span>
<a name="l00164"></a>00164 <span class="comment">/* the data that follows in the SMB packet, so the code will have to   */</span>
<a name="l00165"></a>00165 <span class="comment">/* take that into account.                                             */</span>
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="smblib-priv_8h.html#a9a20f8c32ef21027d1db739cd0e7dc95">00167</a> <span class="preprocessor">#define SMB_hdr_idf_offset    0          </span><span class="comment">/* 0xFF,&#39;SMB&#39; 0-3 */</span>
<a name="l00168"></a><a class="code" href="smblib-priv_8h.html#aec7259c2a6217b157a0861e1e2359354">00168</a> <span class="preprocessor">#define SMB_hdr_com_offset    4          </span><span class="comment">/* BYTE       4   */</span>
<a name="l00169"></a><a class="code" href="smblib-priv_8h.html#a221a732ce3c0e46f2e2b07f54179dc32">00169</a> <span class="preprocessor">#define SMB_hdr_rcls_offset   5          </span><span class="comment">/* BYTE       5   */</span>
<a name="l00170"></a><a class="code" href="smblib-priv_8h.html#aeb1d6af58712d7de18a818912b50ba18">00170</a> <span class="preprocessor">#define SMB_hdr_reh_offset    6          </span><span class="comment">/* BYTE       6   */</span>
<a name="l00171"></a><a class="code" href="smblib-priv_8h.html#a5d77ca97f2bd86ec8c1fb0f6a8e10402">00171</a> <span class="preprocessor">#define SMB_hdr_err_offset    7          </span><span class="comment">/* WORD       7   */</span>
<a name="l00172"></a><a class="code" href="smblib-priv_8h.html#a2d54fd1c65785f989ac56671b6bc5d9a">00172</a> <span class="preprocessor">#define SMB_hdr_reb_offset    9          </span><span class="comment">/* BYTE       9   */</span>
<a name="l00173"></a><a class="code" href="smblib-priv_8h.html#a2245f579cb573be08c7c8e6e9e187f44">00173</a> <span class="preprocessor">#define SMB_hdr_flg_offset    9          </span><span class="comment">/* same as reb ...*/</span>
<a name="l00174"></a><a class="code" href="smblib-priv_8h.html#a4bc4e86d11a2b346cfbf43cf9ad82ecf">00174</a> <span class="preprocessor">#define SMB_hdr_res_offset    10         </span><span class="comment">/* 7 WORDs    10  */</span>
<a name="l00175"></a><a class="code" href="smblib-priv_8h.html#a1038bd5fbae1ad69d3870087e022d5b1">00175</a> <span class="preprocessor">#define SMB_hdr_res0_offset   10         </span><span class="comment">/* WORD       10  */</span>
<a name="l00176"></a><a class="code" href="smblib-priv_8h.html#ac9b9482503ecf40e2606ec7d59238f34">00176</a> <span class="preprocessor">#define SMB_hdr_flg2_offset   10         </span><span class="comment">/* WORD           */</span>
<a name="l00177"></a><a class="code" href="smblib-priv_8h.html#a917d7466baddb00bc59807e6451730c2">00177</a> <span class="preprocessor">#define SMB_hdr_res1_offset   12         </span><span class="comment">/* WORD       12  */</span>
<a name="l00178"></a><a class="code" href="smblib-priv_8h.html#ad1bda153c52404deca0bd3f1a39c3f04">00178</a> <span class="preprocessor">#define SMB_hdr_res2_offset   14</span>
<a name="l00179"></a><a class="code" href="smblib-priv_8h.html#a2725c9aba8b1864d0818d45a02a459c2">00179</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_hdr_res3_offset   16</span>
<a name="l00180"></a><a class="code" href="smblib-priv_8h.html#af525f4a3369f2d6115735e592b9cbec2">00180</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_hdr_res4_offset   18</span>
<a name="l00181"></a><a class="code" href="smblib-priv_8h.html#a23250464e4230568d54e3fde8626d752">00181</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_hdr_res5_offset   20</span>
<a name="l00182"></a><a class="code" href="smblib-priv_8h.html#aefd4e4adb8b07873fce429f25632b8a5">00182</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_hdr_res6_offset   22</span>
<a name="l00183"></a><a class="code" href="smblib-priv_8h.html#ad7c380933b8ad7a1d91921b42d198250">00183</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_hdr_tid_offset    24</span>
<a name="l00184"></a><a class="code" href="smblib-priv_8h.html#aaf43478226fa478cfb6117308cb43461">00184</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_hdr_pid_offset    26</span>
<a name="l00185"></a><a class="code" href="smblib-priv_8h.html#aa4eb620402333c30f4c691fb815e4628">00185</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_hdr_uid_offset    28</span>
<a name="l00186"></a><a class="code" href="smblib-priv_8h.html#a8c110a4007462d23cb21c7c72fec4715">00186</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_hdr_mid_offset    30</span>
<a name="l00187"></a><a class="code" href="smblib-priv_8h.html#a24b87728e5b5269123a3169182b58a26">00187</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_hdr_wct_offset    32</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span>
<a name="l00189"></a><a class="code" href="smblib-priv_8h.html#ad6d5711a98dd0ce5fbb59508f80ab100">00189</a> <span class="preprocessor">#define SMB_hdr_len           33        </span><span class="comment">/* 33 byte header?      */</span>
<a name="l00190"></a>00190 
<a name="l00191"></a><a class="code" href="smblib-priv_8h.html#a12d180ea995ff9210be9ee33b2a64a9e">00191</a> <span class="preprocessor">#define SMB_hdr_axc_offset    33        </span><span class="comment">/* AndX Command         */</span>
<a name="l00192"></a><a class="code" href="smblib-priv_8h.html#a4d5801e65ec3e2143499358986caa57f">00192</a> <span class="preprocessor">#define SMB_hdr_axr_offset    34        </span><span class="comment">/* AndX Reserved        */</span>
<a name="l00193"></a><a class="code" href="smblib-priv_8h.html#a600e4206cf1957478269f006f07cccf0">00193</a> <span class="preprocessor">#define SMB_hdr_axo_offset    35     </span><span class="comment">/* Offset from start to WCT of AndX cmd */</span>
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="comment">/* Format of the Negotiate Protocol SMB */</span>
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="smblib-priv_8h.html#a5e571a2bb59c6f652b5211a6c87c2f05">00197</a> <span class="preprocessor">#define SMB_negp_bcc_offset   33</span>
<a name="l00198"></a><a class="code" href="smblib-priv_8h.html#a99121ff439e54fd70e44a3b073061c98">00198</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_negp_buf_offset   35        </span><span class="comment">/* Where the buffer starts   */</span>
<a name="l00199"></a><a class="code" href="smblib-priv_8h.html#a1c020bdcd51306a494ab4598a697f606">00199</a> <span class="preprocessor">#define SMB_negp_len          35        </span><span class="comment">/* plus the data             */</span>
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="comment">/* Format of the Negotiate Response SMB, for CoreProtocol, LM1.2 and */</span>
<a name="l00202"></a>00202 <span class="comment">/* NT LM 0.12. wct will be 1 for CoreProtocol, 13 for LM 1.2, and 17 */</span>
<a name="l00203"></a>00203 <span class="comment">/* for NT LM 0.12                                                    */</span>
<a name="l00204"></a>00204 
<a name="l00205"></a><a class="code" href="smblib-priv_8h.html#ae5add881054e4c74d35a35d35e2e2ebb">00205</a> <span class="preprocessor">#define SMB_negrCP_idx_offset   33        </span><span class="comment">/* Response to the neg req */</span>
<a name="l00206"></a><a class="code" href="smblib-priv_8h.html#ac910e1b0db9c16f37a14efe88f52d361">00206</a> <span class="preprocessor">#define SMB_negrCP_bcc_offset   35</span>
<a name="l00207"></a><a class="code" href="smblib-priv_8h.html#a9f0362a357777b56dc11ce216b937916">00207</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_negrLM_idx_offset   33        </span><span class="comment">/* dialect index           */</span>
<a name="l00208"></a><a class="code" href="smblib-priv_8h.html#a62772b033a2823c6b26032636ca0121b">00208</a> <span class="preprocessor">#define SMB_negrLM_sec_offset   35        </span><span class="comment">/* Security mode           */</span>
<a name="l00209"></a><a class="code" href="smblib-priv_8h.html#a6dacac3f8523ab46f942bb1887e4b060">00209</a> <span class="preprocessor">#define SMB_sec_user_mask       0x01      </span><span class="comment">/* 0 = share, 1 = user     */</span>
<a name="l00210"></a><a class="code" href="smblib-priv_8h.html#a77a260a55cf320c8ffee5077a01992b7">00210</a> <span class="preprocessor">#define SMB_sec_encrypt_mask    0x02      </span><span class="comment">/* pick out encrypt        */</span>
<a name="l00211"></a><a class="code" href="smblib-priv_8h.html#a84dbd9bfe521e371bfd6fb0af7d83447">00211</a> <span class="preprocessor">#define SMB_negrLM_mbs_offset   37        </span><span class="comment">/* max buffer size         */</span>
<a name="l00212"></a><a class="code" href="smblib-priv_8h.html#a6ffef7192ad98b37530782cd27f9a008">00212</a> <span class="preprocessor">#define SMB_negrLM_mmc_offset   39        </span><span class="comment">/* max mpx count           */</span>
<a name="l00213"></a><a class="code" href="smblib-priv_8h.html#a4c6c2ba0560deae94a10c0737ff489e3">00213</a> <span class="preprocessor">#define SMB_negrLM_mnv_offset   41        </span><span class="comment">/* max number of VCs       */</span>
<a name="l00214"></a><a class="code" href="smblib-priv_8h.html#ab9e58e28faa35e3a479a9b3b3dc4867f">00214</a> <span class="preprocessor">#define SMB_negrLM_rm_offset    43        </span><span class="comment">/* raw mode support bit vec*/</span>
<a name="l00215"></a><a class="code" href="smblib-priv_8h.html#a61a5137ba4e0cbe3ed7f87df709f33a0">00215</a> <span class="preprocessor">#define SMB_read_raw_mask       0x01</span>
<a name="l00216"></a><a class="code" href="smblib-priv_8h.html#af130ac7c9bea16f66a465f6c47c54e30">00216</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_write_raw_mask      0x02</span>
<a name="l00217"></a><a class="code" href="smblib-priv_8h.html#a6056808fe5b096600eb24c2f1940f327">00217</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_negrLM_sk_offset    45        </span><span class="comment">/* session key, 32 bits    */</span>
<a name="l00218"></a><a class="code" href="smblib-priv_8h.html#a54226c86688280b0812f64a3a0f917b4">00218</a> <span class="preprocessor">#define SMB_negrLM_st_offset    49        </span><span class="comment">/* Current server time     */</span>
<a name="l00219"></a><a class="code" href="smblib-priv_8h.html#a8ca6ea28c47551952d8feb0ca6805621">00219</a> <span class="preprocessor">#define SMB_negrLM_sd_offset    51        </span><span class="comment">/* Current server date     */</span>
<a name="l00220"></a><a class="code" href="smblib-priv_8h.html#abc05f86c9e3a07f6c5ba9bb879fb9347">00220</a> <span class="preprocessor">#define SMB_negrLM_stz_offset   53        </span><span class="comment">/* Server Time Zone        */</span>
<a name="l00221"></a><a class="code" href="smblib-priv_8h.html#a89499158f1e11bfe50ef8d012abba826">00221</a> <span class="preprocessor">#define SMB_negrLM_ekl_offset   55        </span><span class="comment">/* encryption key length   */</span>
<a name="l00222"></a><a class="code" href="smblib-priv_8h.html#a9d0ed29a0ed7efe1075f765436f634e0">00222</a> <span class="preprocessor">#define SMB_negrLM_res_offset   57        </span><span class="comment">/* reserved                */</span>
<a name="l00223"></a><a class="code" href="smblib-priv_8h.html#aa581eb5ddaa5dd081bccfdd0f80137d5">00223</a> <span class="preprocessor">#define SMB_negrLM_bcc_offset   59        </span><span class="comment">/* bcc                     */</span>
<a name="l00224"></a><a class="code" href="smblib-priv_8h.html#a80d5e1319d04bcdb08a9e0d44321230b">00224</a> <span class="preprocessor">#define SMB_negrLM_len          61        </span><span class="comment">/* 61 bytes ?              */</span>
<a name="l00225"></a><a class="code" href="smblib-priv_8h.html#a30a56e3d38622fdf9f8fb6525a1fd78e">00225</a> <span class="preprocessor">#define SMB_negrLM_buf_offset   61        </span><span class="comment">/* Where the fun begins    */</span>
<a name="l00226"></a>00226 
<a name="l00227"></a><a class="code" href="smblib-priv_8h.html#a9c2432d9d2d2f88c414efdd928589238">00227</a> <span class="preprocessor">#define SMB_negrNTLM_idx_offset 33        </span><span class="comment">/* Selected protocol       */</span>
<a name="l00228"></a><a class="code" href="smblib-priv_8h.html#aa7fedf753b8222bea0cc5a32fca31d88">00228</a> <span class="preprocessor">#define SMB_negrNTLM_sec_offset 35        </span><span class="comment">/* Security more           */</span>
<a name="l00229"></a><a class="code" href="smblib-priv_8h.html#a33aca642594bce19ad85a434a6edbd70">00229</a> <span class="preprocessor">#define SMB_negrNTLM_mmc_offset 36        </span><span class="comment">/* Different format above  */</span>
<a name="l00230"></a><a class="code" href="smblib-priv_8h.html#aff270fd8dcd13c8f00bd8cf7b5fdb496">00230</a> <span class="preprocessor">#define SMB_negrNTLM_mnv_offset 38        </span><span class="comment">/* Max VCs                 */</span>
<a name="l00231"></a><a class="code" href="smblib-priv_8h.html#a4d17a3a67d44a4832e91ff9e8a5782fa">00231</a> <span class="preprocessor">#define SMB_negrNTLM_mbs_offset 40        </span><span class="comment">/* MBS now a long          */</span>
<a name="l00232"></a><a class="code" href="smblib-priv_8h.html#a51551de71cef792bf88f9a187ee48da7">00232</a> <span class="preprocessor">#define SMB_negrNTLM_mrs_offset 44        </span><span class="comment">/* Max raw size            */</span>
<a name="l00233"></a><a class="code" href="smblib-priv_8h.html#ae0e9d219bd5962236b46d79c079e5a74">00233</a> <span class="preprocessor">#define SMB_negrNTLM_sk_offset  48        </span><span class="comment">/* Session Key             */</span>
<a name="l00234"></a><a class="code" href="smblib-priv_8h.html#a083e748cbe7b355c6c6162da9b549ac6">00234</a> <span class="preprocessor">#define SMB_negrNTLM_cap_offset 52        </span><span class="comment">/* Capabilities            */</span>
<a name="l00235"></a><a class="code" href="smblib-priv_8h.html#a1183037b2025d690c587aa3fb0bd5fd2">00235</a> <span class="preprocessor">#define SMB_negrNTLM_stl_offset 56        </span><span class="comment">/* Server time low         */</span>
<a name="l00236"></a><a class="code" href="smblib-priv_8h.html#aeaa127b7a9f29af8d4fcfcf7dc26daba">00236</a> <span class="preprocessor">#define SMB_negrNTLM_sth_offset 60        </span><span class="comment">/* Server time high        */</span>
<a name="l00237"></a><a class="code" href="smblib-priv_8h.html#aa2d07f18ca838188e2eaea4e3769f563">00237</a> <span class="preprocessor">#define SMB_negrNTLM_stz_offset 64        </span><span class="comment">/* Server time zone        */</span>
<a name="l00238"></a><a class="code" href="smblib-priv_8h.html#a5bccef3e5406762534606d1783fff279">00238</a> <span class="preprocessor">#define SMB_negrNTLM_ekl_offset 66        </span><span class="comment">/* Encrypt key len         */</span>
<a name="l00239"></a><a class="code" href="smblib-priv_8h.html#a66daa8be1876829f6bb71faec11c0c30">00239</a> <span class="preprocessor">#define SMB_negrNTLM_bcc_offset 67        </span><span class="comment">/* Bcc                     */</span>
<a name="l00240"></a><a class="code" href="smblib-priv_8h.html#aa9902a99053c43d4c56bb1566a3ec0c9">00240</a> <span class="preprocessor">#define SMB_negrNTLM_len        69</span>
<a name="l00241"></a><a class="code" href="smblib-priv_8h.html#a01c889ade397f45d54712a6f3a4b50b6">00241</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_negrNTLM_buf_offset 69</span>
<a name="l00242"></a>00242 <span class="preprocessor"></span>
<a name="l00243"></a>00243 <span class="comment">/* Offsets related to Tree Connect                                      */</span>
<a name="l00244"></a>00244 
<a name="l00245"></a><a class="code" href="smblib-priv_8h.html#acee1384d224bc58bc4ba9531c9893a21">00245</a> <span class="preprocessor">#define SMB_tcon_bcc_offset     33</span>
<a name="l00246"></a><a class="code" href="smblib-priv_8h.html#a08a8bdfdb171096dbd3a0da5df6d4283">00246</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_tcon_buf_offset     35        </span><span class="comment">/* where the data is for tcon */</span>
<a name="l00247"></a><a class="code" href="smblib-priv_8h.html#ab5bc363d21abdbb6e5f0bcd1a05b3c8b">00247</a> <span class="preprocessor">#define SMB_tcon_len            35        </span><span class="comment">/* plus the data              */</span>
<a name="l00248"></a>00248 
<a name="l00249"></a><a class="code" href="smblib-priv_8h.html#aae091b7fccd5db87c621dfd27b28c95d">00249</a> <span class="preprocessor">#define SMB_tconr_mbs_offset    33        </span><span class="comment">/* max buffer size         */</span>
<a name="l00250"></a><a class="code" href="smblib-priv_8h.html#a91db35efbfaabbb8b5da47a8ceb9ecac">00250</a> <span class="preprocessor">#define SMB_tconr_tid_offset    35        </span><span class="comment">/* returned tree id        */</span>
<a name="l00251"></a><a class="code" href="smblib-priv_8h.html#a12cd66880782f33c805b953fffc1857d">00251</a> <span class="preprocessor">#define SMB_tconr_bcc_offset    37</span>
<a name="l00252"></a><a class="code" href="smblib-priv_8h.html#aa4275e3af61c046feefc56b1143ae93c">00252</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_tconr_len           39</span>
<a name="l00253"></a>00253 <span class="preprocessor"></span>
<a name="l00254"></a><a class="code" href="smblib-priv_8h.html#a28e1be9708550e170d1d2481fe6ad9b0">00254</a> <span class="preprocessor">#define SMB_tconx_axc_offset    33        </span><span class="comment">/* And X Command                */</span>
<a name="l00255"></a><a class="code" href="smblib-priv_8h.html#a12ac9c9cf52adb4b1db770b67d3336b9">00255</a> <span class="preprocessor">#define SMB_tconx_axr_offset    34        </span><span class="comment">/* reserved                     */</span>
<a name="l00256"></a><a class="code" href="smblib-priv_8h.html#ab265122550be010e58836025879b955e">00256</a> <span class="preprocessor">#define SMB_tconx_axo_offset    35        </span><span class="comment">/* Next command offset          */</span>
<a name="l00257"></a><a class="code" href="smblib-priv_8h.html#a69ace91df0ce3202cf1681882b4f2370">00257</a> <span class="preprocessor">#define SMB_tconx_flg_offset    37        </span><span class="comment">/* Flags, bit0=1 means disc TID */</span>
<a name="l00258"></a><a class="code" href="smblib-priv_8h.html#a720af73210c1f8b31d3d72fdc54c2bc9">00258</a> <span class="preprocessor">#define SMB_tconx_pwl_offset    39        </span><span class="comment">/* Password length              */</span>
<a name="l00259"></a><a class="code" href="smblib-priv_8h.html#acb6f5bf917d48d6bcbcde39ec4f048e0">00259</a> <span class="preprocessor">#define SMB_tconx_bcc_offset    41        </span><span class="comment">/* bcc                          */</span>
<a name="l00260"></a><a class="code" href="smblib-priv_8h.html#a3d6e12793988ef8d7b5a78e4d36ae921">00260</a> <span class="preprocessor">#define SMB_tconx_buf_offset    43        </span><span class="comment">/* buffer                       */</span>
<a name="l00261"></a><a class="code" href="smblib-priv_8h.html#a6b9c83bebbf3c8dbb4c6816975a416d4">00261</a> <span class="preprocessor">#define SMB_tconx_len           43        </span><span class="comment">/* up to data ...               */</span>
<a name="l00262"></a>00262 
<a name="l00263"></a><a class="code" href="smblib-priv_8h.html#a1c6400cd5c716f91586782ae2696cfa3">00263</a> <span class="preprocessor">#define SMB_tconxr_axc_offset   33        </span><span class="comment">/* Where the AndX Command is    */</span>
<a name="l00264"></a><a class="code" href="smblib-priv_8h.html#ab3394985e9b222456743c1ca7919712f">00264</a> <span class="preprocessor">#define SMB_tconxr_axr_offset   34        </span><span class="comment">/* Reserved                     */</span>
<a name="l00265"></a><a class="code" href="smblib-priv_8h.html#aad53c409827aa5c32c59c500df92f084">00265</a> <span class="preprocessor">#define SMB_tconxr_axo_offset   35        </span><span class="comment">/* AndX offset location         */</span>
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">/* Offsets related to tree_disconnect                                  */</span>
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="smblib-priv_8h.html#a2a32c93d3f9f32dc935d833e2c022cf6">00269</a> <span class="preprocessor">#define SMB_tdis_bcc_offset     33        </span><span class="comment">/* bcc                     */</span>
<a name="l00270"></a><a class="code" href="smblib-priv_8h.html#ab1af3dd70e1ae216a1c955154ef0ff0a">00270</a> <span class="preprocessor">#define SMB_tdis_len            35        </span><span class="comment">/* total len               */</span>
<a name="l00271"></a>00271 
<a name="l00272"></a><a class="code" href="smblib-priv_8h.html#a8767e99879004d836bc468eebe193783">00272</a> <span class="preprocessor">#define SMB_tdisr_bcc_offset    33        </span><span class="comment">/* bcc                     */</span>
<a name="l00273"></a><a class="code" href="smblib-priv_8h.html#aa0129898c46c8ba8e366bdfd35a3d642">00273</a> <span class="preprocessor">#define SMB_tdisr_len           35</span>
<a name="l00274"></a>00274 <span class="preprocessor"></span>
<a name="l00275"></a>00275 <span class="comment">/* Offsets related to Open Request                                     */</span>
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="smblib-priv_8h.html#ab5a6f8505722d3e1480c1244b04faf1e">00277</a> <span class="preprocessor">#define SMB_open_mod_offset     33        </span><span class="comment">/* Mode to open with       */</span>
<a name="l00278"></a><a class="code" href="smblib-priv_8h.html#a34b1f5c3a02644f721a1ae523304882b">00278</a> <span class="preprocessor">#define SMB_open_atr_offset     35        </span><span class="comment">/* Attributes of file      */</span>
<a name="l00279"></a><a class="code" href="smblib-priv_8h.html#abf37a6bdf453072c5cda9411409390a0">00279</a> <span class="preprocessor">#define SMB_open_bcc_offset     37        </span><span class="comment">/* bcc                     */</span>
<a name="l00280"></a><a class="code" href="smblib-priv_8h.html#a2ee33c333155c5ff6b6d3bd35164dfbc">00280</a> <span class="preprocessor">#define SMB_open_buf_offset     39        </span><span class="comment">/* File name               */</span>
<a name="l00281"></a><a class="code" href="smblib-priv_8h.html#a6a11e7b6cefd9dc4ad6945f0f59ee0c1">00281</a> <span class="preprocessor">#define SMB_open_len            39        </span><span class="comment">/* Plus the file name      */</span>
<a name="l00282"></a>00282 
<a name="l00283"></a><a class="code" href="smblib-priv_8h.html#a5829194fa4d05b5133afaf883a64195d">00283</a> <span class="preprocessor">#define SMB_openx_axc_offset    33        </span><span class="comment">/* Next command            */</span>
<a name="l00284"></a><a class="code" href="smblib-priv_8h.html#ad9294af3807db2780920346aa51b1a45">00284</a> <span class="preprocessor">#define SMB_openx_axr_offset    34        </span><span class="comment">/* Reserved                */</span>
<a name="l00285"></a><a class="code" href="smblib-priv_8h.html#a542a6324ca46b1ee1c8e42cfb60f4aa7">00285</a> <span class="preprocessor">#define SMB_openx_axo_offset    35        </span><span class="comment">/* offset of next wct      */</span>
<a name="l00286"></a><a class="code" href="smblib-priv_8h.html#ab110de00d3be917ce8135bae47b682fb">00286</a> <span class="preprocessor">#define SMB_openx_flg_offset    37        </span><span class="comment">/* Flags, bit0 = need more info */</span>
<a name="l00287"></a>00287                                           <span class="comment">/* bit1 = exclusive oplock */</span>
<a name="l00288"></a>00288                                           <span class="comment">/* bit2 = batch oplock     */</span>
<a name="l00289"></a><a class="code" href="smblib-priv_8h.html#ad59269e6eb3c4d0f71ab5cb7f0d6449b">00289</a> <span class="preprocessor">#define SMB_openx_mod_offset    39        </span><span class="comment">/* mode to open with       */</span>
<a name="l00290"></a><a class="code" href="smblib-priv_8h.html#acdfbc56a2b04154038199bebad1f92da">00290</a> <span class="preprocessor">#define SMB_openx_atr_offset    41        </span><span class="comment">/* search attributes       */</span>
<a name="l00291"></a><a class="code" href="smblib-priv_8h.html#ae9c2afc43326f90c857373bf68de5ea2">00291</a> <span class="preprocessor">#define SMB_openx_fat_offset    43        </span><span class="comment">/* File attributes         */</span>
<a name="l00292"></a><a class="code" href="smblib-priv_8h.html#a3ecc423bb37756bd3de13f3137c9cdb4">00292</a> <span class="preprocessor">#define SMB_openx_tim_offset    45        </span><span class="comment">/* time and date of creat  */</span>
<a name="l00293"></a><a class="code" href="smblib-priv_8h.html#a3edfbc7b762958900fb7d674f059ae10">00293</a> <span class="preprocessor">#define SMB_openx_ofn_offset    49        </span><span class="comment">/* Open function           */</span>
<a name="l00294"></a><a class="code" href="smblib-priv_8h.html#a32df8967678a840d531da08d3b23ef49">00294</a> <span class="preprocessor">#define SMB_openx_als_offset    51        </span><span class="comment">/* Space to allocate on    */</span>
<a name="l00295"></a><a class="code" href="smblib-priv_8h.html#a0f37e53d6152f844471b5f5a5c34071d">00295</a> <span class="preprocessor">#define SMB_openx_res_offset    55        </span><span class="comment">/* reserved                */</span>
<a name="l00296"></a><a class="code" href="smblib-priv_8h.html#a3d7d27c86a6078ae6f467f7c6698f8c7">00296</a> <span class="preprocessor">#define SMB_openx_bcc_offset    63        </span><span class="comment">/* bcc                     */</span>
<a name="l00297"></a><a class="code" href="smblib-priv_8h.html#a5cdc7959ffdd78521797a7ea72538d58">00297</a> <span class="preprocessor">#define SMB_openx_buf_offset    65        </span><span class="comment">/* Where file name goes    */</span>
<a name="l00298"></a><a class="code" href="smblib-priv_8h.html#a680b0ac29dc5e23f6f12ce1e3ac2378c">00298</a> <span class="preprocessor">#define SMB_openx_len           65</span>
<a name="l00299"></a>00299 <span class="preprocessor"></span>
<a name="l00300"></a><a class="code" href="smblib-priv_8h.html#acaf848e80b281231f9addaae26473092">00300</a> <span class="preprocessor">#define SMB_openr_fid_offset    33        </span><span class="comment">/* FID returned            */</span>
<a name="l00301"></a><a class="code" href="smblib-priv_8h.html#ae70565e8b0e28b53552653457b035eb5">00301</a> <span class="preprocessor">#define SMB_openr_atr_offset    35        </span><span class="comment">/* Attributes opened with  */</span>
<a name="l00302"></a><a class="code" href="smblib-priv_8h.html#a062b793b25005734f58bd287b30f62fd">00302</a> <span class="preprocessor">#define SMB_openr_tim_offset    37        </span><span class="comment">/* Last mod time of file   */</span>
<a name="l00303"></a><a class="code" href="smblib-priv_8h.html#a20e642d2c7aca383a18b732b1d96ac03">00303</a> <span class="preprocessor">#define SMB_openr_fsz_offset    41        </span><span class="comment">/* File size 4 bytes       */</span>
<a name="l00304"></a><a class="code" href="smblib-priv_8h.html#a7d992aa969026077e39199587c2b2e46">00304</a> <span class="preprocessor">#define SMB_openr_acc_offset    45        </span><span class="comment">/* Access allowed          */</span>
<a name="l00305"></a><a class="code" href="smblib-priv_8h.html#a3b5bd6f4d50457684ead5b85364d804d">00305</a> <span class="preprocessor">#define SMB_openr_bcc_offset    47</span>
<a name="l00306"></a><a class="code" href="smblib-priv_8h.html#a6a0844ac50a574beaea535102ad220ea">00306</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_openr_len           49</span>
<a name="l00307"></a>00307 <span class="preprocessor"></span>
<a name="l00308"></a><a class="code" href="smblib-priv_8h.html#a6505aac12a21b7c082ea4ec096a5a00c">00308</a> <span class="preprocessor">#define SMB_openxr_axc_offset   33        </span><span class="comment">/* And X command           */</span>
<a name="l00309"></a><a class="code" href="smblib-priv_8h.html#a7680ca320e203d8d6e84660deb831979">00309</a> <span class="preprocessor">#define SMB_openxr_axr_offset   34        </span><span class="comment">/* reserved                */</span>
<a name="l00310"></a><a class="code" href="smblib-priv_8h.html#a48792108f07b56e28fb0210504d2c4a0">00310</a> <span class="preprocessor">#define SMB_openxr_axo_offset   35        </span><span class="comment">/* offset to next command  */</span>
<a name="l00311"></a><a class="code" href="smblib-priv_8h.html#a8ebd239e3d3b65f716e83110debfbeca">00311</a> <span class="preprocessor">#define SMB_openxr_fid_offset   37        </span><span class="comment">/* FID returned            */</span>
<a name="l00312"></a><a class="code" href="smblib-priv_8h.html#a51d750a10d58b7a80790f81340eec950">00312</a> <span class="preprocessor">#define SMB_openxr_fat_offset   39        </span><span class="comment">/* File attributes returned*/</span>
<a name="l00313"></a><a class="code" href="smblib-priv_8h.html#a9ef6a8c27d710dfc773eda5952c2fa6d">00313</a> <span class="preprocessor">#define SMB_openxr_tim_offset   41        </span><span class="comment">/* File creation date etc  */</span>
<a name="l00314"></a><a class="code" href="smblib-priv_8h.html#ad196aaf8130aab087152693bf5f601de">00314</a> <span class="preprocessor">#define SMB_openxr_fsz_offset   45        </span><span class="comment">/* Size of file            */</span>
<a name="l00315"></a><a class="code" href="smblib-priv_8h.html#a4a304bbc53e5d2aa26c1afe97cc5cde5">00315</a> <span class="preprocessor">#define SMB_openxr_acc_offset   49        </span><span class="comment">/* Access granted          */</span>
<a name="l00316"></a>00316 
<a name="l00317"></a><a class="code" href="smblib-priv_8h.html#ad8e54a6121c25263079e5464f3a72c26">00317</a> <span class="preprocessor">#define SMB_clos_fid_offset     33        </span><span class="comment">/* FID to close            */</span>
<a name="l00318"></a><a class="code" href="smblib-priv_8h.html#a8fd38b3656e2aee473d44525e22fc89c">00318</a> <span class="preprocessor">#define SMB_clos_tim_offset     35        </span><span class="comment">/* Last mod time           */</span>
<a name="l00319"></a><a class="code" href="smblib-priv_8h.html#af3fa3993af97c6c7046af08ff96c1c96">00319</a> <span class="preprocessor">#define SMB_clos_bcc_offset     39        </span><span class="comment">/* bcc                     */</span>
<a name="l00320"></a><a class="code" href="smblib-priv_8h.html#a23c571c7b4b70f16acb74c1bd1ba8b18">00320</a> <span class="preprocessor">#define SMB_clos_len            41</span>
<a name="l00321"></a>00321 <span class="preprocessor"></span>
<a name="l00322"></a>00322 <span class="comment">/* Offsets related to Write requests                                 */</span>
<a name="l00323"></a>00323 
<a name="l00324"></a><a class="code" href="smblib-priv_8h.html#a68ac304de20b620351aaa5b6a8fca0c8">00324</a> <span class="preprocessor">#define SMB_write_fid_offset    33        </span><span class="comment">/* FID to write            */</span>
<a name="l00325"></a><a class="code" href="smblib-priv_8h.html#a23a5fa05778e4bf4ea062a147db0ddea">00325</a> <span class="preprocessor">#define SMB_write_cnt_offset    35        </span><span class="comment">/* bytes to write          */</span>
<a name="l00326"></a><a class="code" href="smblib-priv_8h.html#ad7ac1dceab4613838be05217085973bf">00326</a> <span class="preprocessor">#define SMB_write_ofs_offset    37        </span><span class="comment">/* location to write to    */</span>
<a name="l00327"></a><a class="code" href="smblib-priv_8h.html#a85dd6653309727a1c737737b341f758c">00327</a> <span class="preprocessor">#define SMB_write_clf_offset    41        </span><span class="comment">/* advisory count left     */</span>
<a name="l00328"></a><a class="code" href="smblib-priv_8h.html#a0a394ad7364d3b1c0b13f06819982d93">00328</a> <span class="preprocessor">#define SMB_write_bcc_offset    43        </span><span class="comment">/* bcc = data bytes + 3    */</span>
<a name="l00329"></a><a class="code" href="smblib-priv_8h.html#a436d3ba292265205d4d86d6c2baa56c9">00329</a> <span class="preprocessor">#define SMB_write_buf_offset    45        </span><span class="comment">/* Data=0x01, len, data    */</span>
<a name="l00330"></a><a class="code" href="smblib-priv_8h.html#ac863fd8d2679aa75a5c9de67e41a0a4c">00330</a> <span class="preprocessor">#define SMB_write_len           45        </span><span class="comment">/* plus the data ...       */</span>
<a name="l00331"></a>00331 
<a name="l00332"></a><a class="code" href="smblib-priv_8h.html#adf1e46092b13faf01a18bdbe2dab4a6a">00332</a> <span class="preprocessor">#define SMB_writr_cnt_offset    33        </span><span class="comment">/* Count of bytes written  */</span>
<a name="l00333"></a><a class="code" href="smblib-priv_8h.html#a1b717fe21fdfc35d8171ea698af75a48">00333</a> <span class="preprocessor">#define SMB_writr_bcc_offset    35        </span><span class="comment">/* bcc                     */</span>
<a name="l00334"></a><a class="code" href="smblib-priv_8h.html#a2345ebc7a3b4071f74802bdcc18e3ee0">00334</a> <span class="preprocessor">#define SMB_writr_len           37</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>
<a name="l00336"></a>00336 <span class="comment">/* Offsets related to read requests */</span>
<a name="l00337"></a>00337 
<a name="l00338"></a><a class="code" href="smblib-priv_8h.html#aa5f81a5ad7a93fd50006b22cd9ad9189">00338</a> <span class="preprocessor">#define SMB_read_fid_offset     33        </span><span class="comment">/* FID of file to read     */</span>
<a name="l00339"></a><a class="code" href="smblib-priv_8h.html#aa020a354a2c40ad1ea0a51f2e3d1257e">00339</a> <span class="preprocessor">#define SMB_read_cnt_offset     35        </span><span class="comment">/* count of words to read  */</span>
<a name="l00340"></a><a class="code" href="smblib-priv_8h.html#a76cd9139c8f09fe03fe6101a9258a174">00340</a> <span class="preprocessor">#define SMB_read_ofs_offset     37        </span><span class="comment">/* Where to read from      */</span>
<a name="l00341"></a><a class="code" href="smblib-priv_8h.html#ab1ab415ccc9e73906cdd2275be84819e">00341</a> <span class="preprocessor">#define SMB_read_clf_offset     41        </span><span class="comment">/* Advisory count to go    */</span>
<a name="l00342"></a><a class="code" href="smblib-priv_8h.html#a34797a0e3ceec09279fa2fb603ba2b6b">00342</a> <span class="preprocessor">#define SMB_read_bcc_offset     43</span>
<a name="l00343"></a><a class="code" href="smblib-priv_8h.html#a12403a497fe73c24fabbe35ecdd6ea3b">00343</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_read_len            45</span>
<a name="l00344"></a>00344 <span class="preprocessor"></span>
<a name="l00345"></a><a class="code" href="smblib-priv_8h.html#a24a0af555654873fedd41cf5a00c9043">00345</a> <span class="preprocessor">#define SMB_readr_cnt_offset    33        </span><span class="comment">/* Count of bytes returned */</span>
<a name="l00346"></a><a class="code" href="smblib-priv_8h.html#a0656692726bb85642c4cf44c70605887">00346</a> <span class="preprocessor">#define SMB_readr_res_offset    35        </span><span class="comment">/* 4 shorts reserved, 8 bytes */</span>
<a name="l00347"></a><a class="code" href="smblib-priv_8h.html#aa8b570fe73c5a044928706da2c56de7f">00347</a> <span class="preprocessor">#define SMB_readr_bcc_offset    43        </span><span class="comment">/* bcc                     */</span>
<a name="l00348"></a><a class="code" href="smblib-priv_8h.html#a4d131a7c87cedb2fafaefa03366cfd0a">00348</a> <span class="preprocessor">#define SMB_readr_bff_offset    45        </span><span class="comment">/* buffer format char = 0x01 */</span>
<a name="l00349"></a><a class="code" href="smblib-priv_8h.html#ac6d01e796457bd28fd21a27b76a790a7">00349</a> <span class="preprocessor">#define SMB_readr_len_offset    46        </span><span class="comment">/* buffer len              */</span>
<a name="l00350"></a><a class="code" href="smblib-priv_8h.html#ae36d2f6198a08e6ac6d91b8644ef1525">00350</a> <span class="preprocessor">#define SMB_readr_len           45        </span><span class="comment">/* length of the readr before data */</span>
<a name="l00351"></a>00351 
<a name="l00352"></a>00352 <span class="comment">/* Offsets for Create file                                           */</span>
<a name="l00353"></a>00353 
<a name="l00354"></a><a class="code" href="smblib-priv_8h.html#add7f5c05363e3f12baded7492f8b1a4e">00354</a> <span class="preprocessor">#define SMB_creat_atr_offset    33        </span><span class="comment">/* Attributes of new file ... */</span>
<a name="l00355"></a><a class="code" href="smblib-priv_8h.html#aac1d9ce849e092b8722da5934609c58d">00355</a> <span class="preprocessor">#define SMB_creat_tim_offset    35        </span><span class="comment">/* Time of creation           */</span>
<a name="l00356"></a><a class="code" href="smblib-priv_8h.html#a8848738b73a1146351152aed2d44255c">00356</a> <span class="preprocessor">#define SMB_creat_dat_offset    37        </span><span class="comment">/* 4004BCE :-)                */</span>
<a name="l00357"></a><a class="code" href="smblib-priv_8h.html#a11c8a6c00a77193efe8eb2cd2b5af1bb">00357</a> <span class="preprocessor">#define SMB_creat_bcc_offset    39        </span><span class="comment">/* bcc                        */</span>
<a name="l00358"></a><a class="code" href="smblib-priv_8h.html#ac6d944f421f9fdd8db6e3114ed7018e5">00358</a> <span class="preprocessor">#define SMB_creat_buf_offset    41</span>
<a name="l00359"></a><a class="code" href="smblib-priv_8h.html#ab3bbf76612b599e49a12003e62359c90">00359</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_creat_len           41        </span><span class="comment">/* Before the data            */</span>
<a name="l00360"></a>00360 
<a name="l00361"></a><a class="code" href="smblib-priv_8h.html#ade5fa12eaf932d3c7b2e5e796d575064">00361</a> <span class="preprocessor">#define SMB_creatr_fid_offset   33        </span><span class="comment">/* FID of created file        */</span>
<a name="l00362"></a>00362 
<a name="l00363"></a>00363 <span class="comment">/* Offsets for Delete file                                           */</span>
<a name="l00364"></a>00364 
<a name="l00365"></a><a class="code" href="smblib-priv_8h.html#a2fac4dafcd085a7eae0dfd21304e8d18">00365</a> <span class="preprocessor">#define SMB_delet_sat_offset    33        </span><span class="comment">/* search attribites          */</span>
<a name="l00366"></a><a class="code" href="smblib-priv_8h.html#abbee07dfb5604a0fc55420e206ae7471">00366</a> <span class="preprocessor">#define SMB_delet_bcc_offset    35        </span><span class="comment">/* bcc                        */</span>
<a name="l00367"></a><a class="code" href="smblib-priv_8h.html#adb95d686e276e8b381968289462b6fc5">00367</a> <span class="preprocessor">#define SMB_delet_buf_offset    37</span>
<a name="l00368"></a><a class="code" href="smblib-priv_8h.html#a64dd225cbe06aa9ea1328b8c7ab13242">00368</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_delet_len           37</span>
<a name="l00369"></a>00369 <span class="preprocessor"></span>
<a name="l00370"></a>00370 <span class="comment">/* Offsets for SESSION_SETUP_ANDX for both LM and NT LM protocols    */</span>
<a name="l00371"></a>00371 
<a name="l00372"></a><a class="code" href="smblib-priv_8h.html#a951f500d4f74527c772848997b902775">00372</a> <span class="preprocessor">#define SMB_ssetpLM_mbs_offset  37        </span><span class="comment">/* Max buffer Size, allow for AndX */</span>
<a name="l00373"></a><a class="code" href="smblib-priv_8h.html#ad6baf615968b9df62a9194e18e6035ba">00373</a> <span class="preprocessor">#define SMB_ssetpLM_mmc_offset  39        </span><span class="comment">/* max multiplex count             */</span>
<a name="l00374"></a><a class="code" href="smblib-priv_8h.html#afb0a98c339d5d63e59ea6de134a35c50">00374</a> <span class="preprocessor">#define SMB_ssetpLM_vcn_offset  41        </span><span class="comment">/* VC number if new VC             */</span>
<a name="l00375"></a><a class="code" href="smblib-priv_8h.html#af36365a2deedee468167c048a4aeedbd">00375</a> <span class="preprocessor">#define SMB_ssetpLM_snk_offset  43        </span><span class="comment">/* Session Key                     */</span>
<a name="l00376"></a><a class="code" href="smblib-priv_8h.html#a506551959ce18bab5462d95ca14639ed">00376</a> <span class="preprocessor">#define SMB_ssetpLM_pwl_offset  47        </span><span class="comment">/* password length                 */</span>
<a name="l00377"></a><a class="code" href="smblib-priv_8h.html#ac2f2fa27a65e706e2d10470b1a1f8611">00377</a> <span class="preprocessor">#define SMB_ssetpLM_res_offset  49        </span><span class="comment">/* reserved                        */</span>
<a name="l00378"></a><a class="code" href="smblib-priv_8h.html#a1f909c77931c3c8715ad8d65ae1a3482">00378</a> <span class="preprocessor">#define SMB_ssetpLM_bcc_offset  53        </span><span class="comment">/* bcc                             */</span>
<a name="l00379"></a><a class="code" href="smblib-priv_8h.html#a8860e28dd9ca6ad0d7dc2447f3df1ff6">00379</a> <span class="preprocessor">#define SMB_ssetpLM_len         55        </span><span class="comment">/* before data ...                 */</span>
<a name="l00380"></a><a class="code" href="smblib-priv_8h.html#a9f9d7a6d6ea0c061069bd5fb31edc9f4">00380</a> <span class="preprocessor">#define SMB_ssetpLM_buf_offset  55</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span>
<a name="l00382"></a><a class="code" href="smblib-priv_8h.html#a337d7d9bcd9e8c0e44bdc8ec21f81fde">00382</a> <span class="preprocessor">#define SMB_ssetpNTLM_mbs_offset 37       </span><span class="comment">/* Max Buffer Size for NT LM 0.12  */</span>
<a name="l00383"></a>00383                                           <span class="comment">/* and above                       */</span>
<a name="l00384"></a><a class="code" href="smblib-priv_8h.html#a0bc265fd3bb0bd36480e0a2dda66ecb5">00384</a> <span class="preprocessor">#define SMB_ssetpNTLM_mmc_offset 39       </span><span class="comment">/* Max Multiplex count             */</span>
<a name="l00385"></a><a class="code" href="smblib-priv_8h.html#aad67fc684c1b0538d20e48a2187c55b7">00385</a> <span class="preprocessor">#define SMB_ssetpNTLM_vcn_offset 41       </span><span class="comment">/* VC Number                       */</span>
<a name="l00386"></a><a class="code" href="smblib-priv_8h.html#a45fd519f9f0a00478afc572ca8cdc3f8">00386</a> <span class="preprocessor">#define SMB_ssetpNTLM_snk_offset 43       </span><span class="comment">/* Session key                     */</span>
<a name="l00387"></a><a class="code" href="smblib-priv_8h.html#a5929c7d86e7cc6f863f1389bf65cd763">00387</a> <span class="preprocessor">#define SMB_ssetpNTLM_cipl_offset 47      </span><span class="comment">/* Case Insensitive PW Len         */</span>
<a name="l00388"></a><a class="code" href="smblib-priv_8h.html#a8ad0c50955da10efc58ca3c37d881d80">00388</a> <span class="preprocessor">#define SMB_ssetpNTLM_cspl_offset 49      </span><span class="comment">/* Unicode pw len                  */</span>
<a name="l00389"></a><a class="code" href="smblib-priv_8h.html#a1f1e25236ee6ed3ab984e5ed4a9f95aa">00389</a> <span class="preprocessor">#define SMB_ssetpNTLM_res_offset 51       </span><span class="comment">/* reserved                        */</span>
<a name="l00390"></a><a class="code" href="smblib-priv_8h.html#a26047bb737640b74170c2a860f61059d">00390</a> <span class="preprocessor">#define SMB_ssetpNTLM_cap_offset 55       </span><span class="comment">/* server capabilities             */</span>
<a name="l00391"></a><a class="code" href="smblib-priv_8h.html#aeba169b823294528872cdebaa9af8f4a">00391</a> <span class="preprocessor">#define SMB_ssetpNTLM_bcc_offset 59       </span><span class="comment">/* bcc                             */</span>
<a name="l00392"></a><a class="code" href="smblib-priv_8h.html#aa87f682ddbfe827236f7c874540f72e6">00392</a> <span class="preprocessor">#define SMB_ssetpNTLM_len        61       </span><span class="comment">/* before data                     */</span>
<a name="l00393"></a><a class="code" href="smblib-priv_8h.html#ac3aeb3724a80a3d3b93d73f70755612e">00393</a> <span class="preprocessor">#define SMB_ssetpNTLM_buf_offset 61</span>
<a name="l00394"></a>00394 <span class="preprocessor"></span>
<a name="l00395"></a><a class="code" href="smblib-priv_8h.html#a0edce855f171f665b8173bbf0d085849">00395</a> <span class="preprocessor">#define SMB_ssetpr_axo_offset  35         </span><span class="comment">/* Offset of next response ...    */</span>
<a name="l00396"></a><a class="code" href="smblib-priv_8h.html#a20402f1f327ae632a505635394587ea7">00396</a> <span class="preprocessor">#define SMB_ssetpr_act_offset  37         </span><span class="comment">/* action, bit 0 = 1 =&gt; guest     */</span>
<a name="l00397"></a><a class="code" href="smblib-priv_8h.html#a6e3ebaa9abe81f5ae7d06082ac065097">00397</a> <span class="preprocessor">#define SMB_ssetpr_bcc_offset  39         </span><span class="comment">/* bcc                            */</span>
<a name="l00398"></a><a class="code" href="smblib-priv_8h.html#a4d0637b2992141423c502ef5befb666b">00398</a> <span class="preprocessor">#define SMB_ssetpr_buf_offset  41         </span><span class="comment">/* Native OS etc                  */</span>
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 <span class="comment">/* Offsets for SMB create directory                                         */</span>
<a name="l00401"></a>00401 
<a name="l00402"></a><a class="code" href="smblib-priv_8h.html#acffb232c763e75d4a167bd25b0ad605f">00402</a> <span class="preprocessor">#define SMB_creatdir_bcc_offset 33        </span><span class="comment">/* only a bcc here                */</span>
<a name="l00403"></a><a class="code" href="smblib-priv_8h.html#a6f5f8594419267146245fcbc4e4f34bf">00403</a> <span class="preprocessor">#define SMB_creatdir_buf_offset 35        </span><span class="comment">/* Where things start             */</span>
<a name="l00404"></a><a class="code" href="smblib-priv_8h.html#a3c8415a82473613f46261ebbaa0b922f">00404</a> <span class="preprocessor">#define SMB_creatdir_len        35</span>
<a name="l00405"></a>00405 <span class="preprocessor"></span>
<a name="l00406"></a>00406 <span class="comment">/* Offsets for SMB delete directory                                         */</span>
<a name="l00407"></a>00407 
<a name="l00408"></a><a class="code" href="smblib-priv_8h.html#a55eadd83c48f71a87792c11513fd9f06">00408</a> <span class="preprocessor">#define SMB_deletdir_bcc_offset 33        </span><span class="comment">/* only a bcc here                */</span>
<a name="l00409"></a><a class="code" href="smblib-priv_8h.html#a1ad72859660536d5f2bea84f5b4bfdfe">00409</a> <span class="preprocessor">#define SMB_deletdir_buf_offset 35        </span><span class="comment">/* where things start             */</span>
<a name="l00410"></a><a class="code" href="smblib-priv_8h.html#a0f8fa1240210d9f5eb6a497bcc96f38e">00410</a> <span class="preprocessor">#define SMB_deletdir_len        35</span>
<a name="l00411"></a>00411 <span class="preprocessor"></span>
<a name="l00412"></a>00412 <span class="comment">/* Offsets for SMB check directory                                          */</span>
<a name="l00413"></a>00413 
<a name="l00414"></a><a class="code" href="smblib-priv_8h.html#ab10a4c7cacb2678cf2ed5bdb710331ff">00414</a> <span class="preprocessor">#define SMB_checkdir_bcc_offset 33        </span><span class="comment">/* Only a bcc here                */</span>
<a name="l00415"></a><a class="code" href="smblib-priv_8h.html#a46a689bd585580826d43f6b67a3ea6a1">00415</a> <span class="preprocessor">#define SMB_checkdir_buf_offset 35        </span><span class="comment">/* where things start             */</span>
<a name="l00416"></a><a class="code" href="smblib-priv_8h.html#ace2322a757e5856e04787f16b0b47e7e">00416</a> <span class="preprocessor">#define SMB_checkdir_len        35</span>
<a name="l00417"></a>00417 <span class="preprocessor"></span>
<a name="l00418"></a>00418 <span class="comment">/* Offsets for SMB search                                                   */</span>
<a name="l00419"></a>00419 
<a name="l00420"></a><a class="code" href="smblib-priv_8h.html#a269f299136860553ce882b5f30b10afe">00420</a> <span class="preprocessor">#define SMB_search_mdc_offset   33        </span><span class="comment">/* Max Dir ents to return         */</span>
<a name="l00421"></a><a class="code" href="smblib-priv_8h.html#a214e33821abdd680424954b23d10e736">00421</a> <span class="preprocessor">#define SMB_search_atr_offset   35        </span><span class="comment">/* Search attributes              */</span>
<a name="l00422"></a><a class="code" href="smblib-priv_8h.html#ac4a222c725bb51b76fd25b8ca9e393c1">00422</a> <span class="preprocessor">#define SMB_search_bcc_offset   37        </span><span class="comment">/* bcc                            */</span>
<a name="l00423"></a><a class="code" href="smblib-priv_8h.html#a6328e8c2a32b4cdda89f6605768941e3">00423</a> <span class="preprocessor">#define SMB_search_buf_offset   39        </span><span class="comment">/* where the action is            */</span>
<a name="l00424"></a><a class="code" href="smblib-priv_8h.html#a55cb2a487a2b1b85a7f99263ca713c31">00424</a> <span class="preprocessor">#define SMB_search_len          39</span>
<a name="l00425"></a>00425 <span class="preprocessor"></span>
<a name="l00426"></a><a class="code" href="smblib-priv_8h.html#a2768d99f7792ec5558172b7449059270">00426</a> <span class="preprocessor">#define SMB_searchr_dec_offset  33        </span><span class="comment">/* Dir ents returned              */</span>
<a name="l00427"></a><a class="code" href="smblib-priv_8h.html#aecf483271542dc635cc9f9f5dc514ec7">00427</a> <span class="preprocessor">#define SMB_searchr_bcc_offset  35        </span><span class="comment">/* bcc                            */</span>
<a name="l00428"></a><a class="code" href="smblib-priv_8h.html#a2dcd733706bb9f243e414b95dd308bc5">00428</a> <span class="preprocessor">#define SMB_searchr_buf_offset  37        </span><span class="comment">/* Where the action starts        */</span>
<a name="l00429"></a><a class="code" href="smblib-priv_8h.html#a9484fad4b7112beb769c7376b41fb918">00429</a> <span class="preprocessor">#define SMB_searchr_len         37        </span><span class="comment">/* before the dir ents            */</span>
<a name="l00430"></a>00430 
<a name="l00431"></a><a class="code" href="smblib-priv_8h.html#a05905db2bb6e6ed228a2d71ed4ed3c4a">00431</a> <span class="preprocessor">#define SMB_searchr_dirent_len  43        </span><span class="comment">/* 53 bytes                       */</span>
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 <span class="comment">/* Defines for SMB transact and transact2 calls                             */</span>
<a name="l00434"></a>00434 
<a name="l00435"></a><a class="code" href="smblib-priv_8h.html#a5d8f84f37f692ee9d131d2c47982ee08">00435</a> <span class="preprocessor">#define SMB_trans_tpc_offset    33        </span><span class="comment">/* Total param count              */</span>
<a name="l00436"></a><a class="code" href="smblib-priv_8h.html#ae16f13ab04ac97d7c04e91c884e4498f">00436</a> <span class="preprocessor">#define SMB_trans_tdc_offset    35        </span><span class="comment">/* total Data count               */</span>
<a name="l00437"></a><a class="code" href="smblib-priv_8h.html#a9a624090e25839c1fd1e8c567e475f70">00437</a> <span class="preprocessor">#define SMB_trans_mpc_offset    37        </span><span class="comment">/* Max params bytes to return     */</span>
<a name="l00438"></a><a class="code" href="smblib-priv_8h.html#a0b051ea7ae55c6e1aef2be44690cc130">00438</a> <span class="preprocessor">#define SMB_trans_mdc_offset    39        </span><span class="comment">/* Max data bytes to return       */</span>
<a name="l00439"></a><a class="code" href="smblib-priv_8h.html#a4d5be5d88a3372af4810265fa802fb1b">00439</a> <span class="preprocessor">#define SMB_trans_msc_offset    41        </span><span class="comment">/* Max setup words to return      */</span>
<a name="l00440"></a><a class="code" href="smblib-priv_8h.html#a8b1292bde859d6954b3677299aa1f386">00440</a> <span class="preprocessor">#define SMB_trans_rs1_offset    42        </span><span class="comment">/* Reserved byte                  */</span>
<a name="l00441"></a><a class="code" href="smblib-priv_8h.html#afb4b3419e3e61ad455cabb9ee849df99">00441</a> <span class="preprocessor">#define SMB_trans_flg_offset    43        </span><span class="comment">/* flags                          */</span>
<a name="l00442"></a><a class="code" href="smblib-priv_8h.html#a3d8d531f6c01ed44dfd39de32e4ec56b">00442</a> <span class="preprocessor">#define SMB_trans_tmo_offset    45        </span><span class="comment">/* Timeout, long                  */</span>
<a name="l00443"></a><a class="code" href="smblib-priv_8h.html#a0b0330d2fb0cd8f6a428e19e9e073214">00443</a> <span class="preprocessor">#define SMB_trans_rs2_offset    49        </span><span class="comment">/* Next reserved                  */</span>
<a name="l00444"></a><a class="code" href="smblib-priv_8h.html#a17b9ca0ea6de8b264e7ae1e4b4a7fd3c">00444</a> <span class="preprocessor">#define SMB_trans_pbc_offset    51        </span><span class="comment">/* Param Byte count in buf        */</span>
<a name="l00445"></a><a class="code" href="smblib-priv_8h.html#a1271ae9f67e621d2d90ff29cd12ee6e7">00445</a> <span class="preprocessor">#define SMB_trans_pbo_offset    53        </span><span class="comment">/* Offset to param bytes          */</span>
<a name="l00446"></a><a class="code" href="smblib-priv_8h.html#a55bf06e7c8fcc49e9977e032dd8f5bb1">00446</a> <span class="preprocessor">#define SMB_trans_dbc_offset    55        </span><span class="comment">/* Data byte count in buf         */</span>
<a name="l00447"></a><a class="code" href="smblib-priv_8h.html#a9112d3904c04f7ca11de7206ab39c782">00447</a> <span class="preprocessor">#define SMB_trans_dbo_offset    57        </span><span class="comment">/* Data byte offset               */</span>
<a name="l00448"></a><a class="code" href="smblib-priv_8h.html#a2a0839f9056bd16b13a13c47b9b8a384">00448</a> <span class="preprocessor">#define SMB_trans_suc_offset    59        </span><span class="comment">/* Setup count - byte             */</span>
<a name="l00449"></a><a class="code" href="smblib-priv_8h.html#a502e6b7ef8f7fd11fbbecdd91b591b79">00449</a> <span class="preprocessor">#define SMB_trans_rs3_offset    60        </span><span class="comment">/* Reserved to pad ...            */</span>
<a name="l00450"></a><a class="code" href="smblib-priv_8h.html#a0d413827699e20be238b0ec27fefc7ba">00450</a> <span class="preprocessor">#define SMB_trans_len           61        </span><span class="comment">/* Up to setup, still need bcc    */</span>
<a name="l00451"></a>00451 
<a name="l00452"></a><a class="code" href="smblib-priv_8h.html#ade6ae721f8227bcc84b553516615d69f">00452</a> <span class="preprocessor">#define SMB_transr_tpc_offset   33        </span><span class="comment">/* Total param bytes returned     */</span>
<a name="l00453"></a><a class="code" href="smblib-priv_8h.html#a8f210a14257b079ec32f65c5ad4813fe">00453</a> <span class="preprocessor">#define SMB_transr_tdc_offset   35</span>
<a name="l00454"></a><a class="code" href="smblib-priv_8h.html#a620fb2bf766c53752da19c016829d20e">00454</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_transr_rs1_offset   37</span>
<a name="l00455"></a><a class="code" href="smblib-priv_8h.html#af371db09a88da6529a2e3052ff43d39d">00455</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_transr_pbc_offset   39</span>
<a name="l00456"></a><a class="code" href="smblib-priv_8h.html#aa8739af84d056656e769e1a51b34b28f">00456</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_transr_pbo_offset   41</span>
<a name="l00457"></a><a class="code" href="smblib-priv_8h.html#ac08a74de055abe8b87b5a4a82161a064">00457</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_transr_pdi_offset   43        </span><span class="comment">/* parameter displacement         */</span>
<a name="l00458"></a><a class="code" href="smblib-priv_8h.html#a0462551514342997a03b92431356e336">00458</a> <span class="preprocessor">#define SMB_transr_dbc_offset   45</span>
<a name="l00459"></a><a class="code" href="smblib-priv_8h.html#ae3ebff291f264ac87c8609dfadc278e8">00459</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_transr_dbo_offset   47</span>
<a name="l00460"></a><a class="code" href="smblib-priv_8h.html#aa78bd6da0852c80450bb6dff0cf6e775">00460</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_transr_ddi_offset   49</span>
<a name="l00461"></a><a class="code" href="smblib-priv_8h.html#a5bf7c577efff8c2887566e876aca5abb">00461</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_transr_suc_offset   51</span>
<a name="l00462"></a><a class="code" href="smblib-priv_8h.html#ad4cc669172e38425e181057d0b0c0864">00462</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_transr_rs2_offset   52</span>
<a name="l00463"></a><a class="code" href="smblib-priv_8h.html#a00857ce6fe72041bdbdb7a167bde80c2">00463</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_transr_len          53</span>
<a name="l00464"></a>00464 <span class="preprocessor"></span>
<a name="l00465"></a>00465 <span class="comment">/* Bit masks for SMB Capabilities ...                       */</span>
<a name="l00466"></a>00466 
<a name="l00467"></a><a class="code" href="smblib-priv_8h.html#afb42fa0eeca675831daba824536435bc">00467</a> <span class="preprocessor">#define SMB_cap_raw_mode         0x0001</span>
<a name="l00468"></a><a class="code" href="smblib-priv_8h.html#a8837225b1eb5c2bdc17bbbcef44f20c4">00468</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_cap_mpx_mode         0x0002</span>
<a name="l00469"></a><a class="code" href="smblib-priv_8h.html#aa8c6143b6ca05c6b74ff853dbdec804c">00469</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_cap_unicode          0x0004</span>
<a name="l00470"></a><a class="code" href="smblib-priv_8h.html#a91af0b7a204f4e63d1b6ecea03f26ec7">00470</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_cap_large_files      0x0008</span>
<a name="l00471"></a><a class="code" href="smblib-priv_8h.html#a30fd70096a70f9e300ae2c442ca1f9bb">00471</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_cap_nt_smbs          0x0010</span>
<a name="l00472"></a><a class="code" href="smblib-priv_8h.html#a8e040919b804ce4342fa8c7e694aef38">00472</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_rpc_remote_apis      0x0020</span>
<a name="l00473"></a><a class="code" href="smblib-priv_8h.html#a5290dabe6ebb1a26442dbda61dec4e93">00473</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_cap_nt_status        0x0040</span>
<a name="l00474"></a><a class="code" href="smblib-priv_8h.html#a8309ce6f3c563a504b634aa7b9a24c17">00474</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_cap_level_II_oplocks 0x0080</span>
<a name="l00475"></a><a class="code" href="smblib-priv_8h.html#ac38d894a1856c9b43c934e48155308d2">00475</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_cap_lock_and_read    0x0100</span>
<a name="l00476"></a><a class="code" href="smblib-priv_8h.html#a9f91d03978d3a3dbc5c46162b1c53e54">00476</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_cap_nt_find          0x0200</span>
<a name="l00477"></a>00477 <span class="preprocessor"></span>
<a name="l00478"></a>00478 <span class="comment">/* SMB LANMAN api call defines */</span>
<a name="l00479"></a>00479 
<a name="l00480"></a><a class="code" href="smblib-priv_8h.html#a25a3f503ea9219bcd868b055ac305128">00480</a> <span class="preprocessor">#define SMB_LMapi_SetUserInfo     0x0072</span>
<a name="l00481"></a><a class="code" href="smblib-priv_8h.html#a66750141af8edc81d5de1e21c98d08d6">00481</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_LMapi_UserPasswordSet 0x0073</span>
<a name="l00482"></a>00482 <span class="preprocessor"></span>
<a name="l00483"></a>00483 <span class="comment">/* Structures and defines we use in the client interface */</span>
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 <span class="comment">/* The protocols we might support. Perhaps a bit ambitious, as only RFCNB */</span>
<a name="l00486"></a>00486 <span class="comment">/* has any support so far 0(sometimes called NBT)                         */</span>
<a name="l00487"></a>00487 
<a name="l00488"></a><a class="code" href="smblib-priv_8h.html#a2c4fb051781da451f8e01b08c6be6ec2a4b55772e6ee511438d0f37c8802b0d54">00488</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {<a class="code" href="smblib-priv_8h.html#a2c4fb051781da451f8e01b08c6be6ec2ab08087f6afe6fbbf0d597eb4555e6e6f">SMB_RFCNB</a>, <a class="code" href="smblib-priv_8h.html#a2c4fb051781da451f8e01b08c6be6ec2a0faf60e3b2c41ebb91abdf03811e23be">SMB_IPXNB</a>, <a class="code" href="smblib-priv_8h.html#a2c4fb051781da451f8e01b08c6be6ec2acfd627c77990f8a2d8a46b02637448d3">SMB_NETBEUI</a>, <a class="code" href="smblib-priv_8h.html#a2c4fb051781da451f8e01b08c6be6ec2a4b55772e6ee511438d0f37c8802b0d54">SMB_X25</a>} <a class="code" href="smblib-priv_8h.html#a2c4fb051781da451f8e01b08c6be6ec2">SMB_Transport_Types</a>;
<a name="l00489"></a>00489 
<a name="l00490"></a><a class="code" href="smblib-priv_8h.html#a73345d49b710b0cb00ac0aea6455b006">00490</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {<a class="code" href="smblib-priv_8h.html#a73345d49b710b0cb00ac0aea6455b006add44e2c4cce0c76aa26c3ca6b83f2c16">SMB_Con_FShare</a>, <a class="code" href="smblib-priv_8h.html#a73345d49b710b0cb00ac0aea6455b006aa4997b5b2134ab93ee9624df03daac0b">SMB_Con_PShare</a>, <a class="code" href="smblib-priv_8h.html#a73345d49b710b0cb00ac0aea6455b006a153a26bb5d0106bc79095d4bcfd05f9b">SMB_Con_IPC</a>} <a class="code" href="smblib-priv_8h.html#a73345d49b710b0cb00ac0aea6455b006">SMB_Con_Types</a>;
<a name="l00491"></a>00491 
<a name="l00492"></a><a class="code" href="smblib-priv_8h.html#a083cd02bbb9055ea7cadce84fb96e88d">00492</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {<a class="code" href="smblib-priv_8h.html#a083cd02bbb9055ea7cadce84fb96e88da634d8e7644256eb4579b3635daa70a3f">SMB_State_NoState</a>, <a class="code" href="smblib-priv_8h.html#a083cd02bbb9055ea7cadce84fb96e88dac2dc63ced97f2e645e9e5fce5cd1e406">SMB_State_Stopped</a>, <a class="code" href="smblib-priv_8h.html#a083cd02bbb9055ea7cadce84fb96e88dae89984e927e6d158d3ff9571c75cf770">SMB_State_Started</a>} <a class="code" href="smblib-priv_8h.html#a083cd02bbb9055ea7cadce84fb96e88d">SMB_State_Types</a>;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 <span class="comment">/* The following two arrays need to be in step!              */</span>
<a name="l00495"></a>00495 <span class="comment">/* We must make it possible for callers to specify these ... */</span>
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 
<a name="l00498"></a><a class="code" href="smblib-priv_8h.html#a2bc5f215463414b11857513b2b0f50a3">00498</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="smblib-priv_8h.html#a2bc5f215463414b11857513b2b0f50a3">SMB_Prots</a>[] = {<span class="stringliteral">&quot;PC NETWORK PROGRAM 1.0&quot;</span>,
<a name="l00499"></a>00499                             <span class="stringliteral">&quot;MICROSOFT NETWORKS 1.03&quot;</span>,
<a name="l00500"></a>00500                             <span class="stringliteral">&quot;MICROSOFT NETWORKS 3.0&quot;</span>,
<a name="l00501"></a>00501                             <span class="stringliteral">&quot;DOS LANMAN1.0&quot;</span>,
<a name="l00502"></a>00502                             <span class="stringliteral">&quot;LANMAN1.0&quot;</span>,
<a name="l00503"></a>00503                             <span class="stringliteral">&quot;DOS LM1.2X002&quot;</span>,
<a name="l00504"></a>00504                             <span class="stringliteral">&quot;LM1.2X002&quot;</span>,
<a name="l00505"></a>00505                             <span class="stringliteral">&quot;DOS LANMAN2.1&quot;</span>,
<a name="l00506"></a>00506                             <span class="stringliteral">&quot;LANMAN2.1&quot;</span>,
<a name="l00507"></a>00507                             <span class="stringliteral">&quot;Samba&quot;</span>,
<a name="l00508"></a>00508                             <span class="stringliteral">&quot;NT LM 0.12&quot;</span>,
<a name="l00509"></a>00509                             <span class="stringliteral">&quot;NT LANMAN 1.0&quot;</span>,
<a name="l00510"></a>00510                             NULL};
<a name="l00511"></a>00511 
<a name="l00512"></a><a class="code" href="smblib-priv_8h.html#ae4dc17eaf0e0f63b96a73de7e5ab4816">00512</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="smblib-priv_8h.html#ae4dc17eaf0e0f63b96a73de7e5ab4816">SMB_Types</a>[] = {<a class="code" href="smblib-common_8h.html#a0ab9285998cd5a91b92046565e857b05">SMB_P_Core</a>,
<a name="l00513"></a>00513                           <a class="code" href="smblib-common_8h.html#a20c9c64f756a44381f02ed337706fee7">SMB_P_CorePlus</a>,
<a name="l00514"></a>00514                           <a class="code" href="smblib-common_8h.html#ad91122759295fe92e28f8f6ad1eb69de">SMB_P_DOSLanMan1</a>,
<a name="l00515"></a>00515                           <a class="code" href="smblib-common_8h.html#ad91122759295fe92e28f8f6ad1eb69de">SMB_P_DOSLanMan1</a>,
<a name="l00516"></a>00516                           <a class="code" href="smblib-common_8h.html#a7853a164b81c7fb65a343c9934fbd98d">SMB_P_LanMan1</a>,
<a name="l00517"></a>00517                           <a class="code" href="smblib-common_8h.html#a85732e0dbf4bb995094582c40451f114">SMB_P_DOSLanMan2</a>,
<a name="l00518"></a>00518                           <a class="code" href="smblib-common_8h.html#a92f0fb1beaed2e5c03f885a9b61f7f7b">SMB_P_LanMan2</a>,
<a name="l00519"></a>00519                           <a class="code" href="smblib-common_8h.html#a65071312b18c23903a527867393113e9">SMB_P_LanMan2_1</a>,
<a name="l00520"></a>00520                           <a class="code" href="smblib-common_8h.html#a65071312b18c23903a527867393113e9">SMB_P_LanMan2_1</a>,
<a name="l00521"></a>00521                           <a class="code" href="smblib-common_8h.html#ab09d0c1c6da863734b4c9eefc2db0568">SMB_P_NT1</a>,
<a name="l00522"></a>00522                           <a class="code" href="smblib-common_8h.html#ab09d0c1c6da863734b4c9eefc2db0568">SMB_P_NT1</a>,
<a name="l00523"></a>00523                           <a class="code" href="smblib-common_8h.html#ab09d0c1c6da863734b4c9eefc2db0568">SMB_P_NT1</a>,
<a name="l00524"></a>00524                           -1};
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structSMB__Status.html">SMB_Status</a> {
<a name="l00527"></a>00527 
<a name="l00528"></a>00528   <span class="keyword">union </span>{
<a name="l00529"></a>00529     <span class="keyword">struct </span>{
<a name="l00530"></a><a class="code" href="structSMB__Status.html#aa5aeea23297a923840df6237e42a3eca">00530</a>       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structSMB__Status.html#aa5aeea23297a923840df6237e42a3eca">ErrorClass</a>;
<a name="l00531"></a><a class="code" href="structSMB__Status.html#a837cd72c15e1fe5975fa6c9d2f84e1c9">00531</a>       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structSMB__Status.html#a837cd72c15e1fe5975fa6c9d2f84e1c9">Reserved</a>;
<a name="l00532"></a><a class="code" href="structSMB__Status.html#a9293189ba1e830a0359c019e2a17962e">00532</a>       <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="structSMB__Status.html#a9293189ba1e830a0359c019e2a17962e">Error</a>;
<a name="l00533"></a>00533     } <a class="code" href="structSMB__Status.html#af7fd49b2c887bfabca135f1b79896fa5">DosError</a>;
<a name="l00534"></a><a class="code" href="structSMB__Status.html#affa34ea827d58e869bb236c8345a8050">00534</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structSMB__Status.html#affa34ea827d58e869bb236c8345a8050">NtStatus</a>;
<a name="l00535"></a>00535   } <a class="code" href="structSMB__Status.html#a55f7786b4fa25116000da9df7f97311e">status</a>;
<a name="l00536"></a>00536 } <a class="code" href="smblib-priv_8h.html#a1710964e1b14b02359f00f0e8fa174bb">SMB_Status</a>;
<a name="l00537"></a>00537 
<a name="l00538"></a><a class="code" href="smblib-priv_8h.html#af9495575fd1f1b35acf15252d318194e">00538</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structSMB__Tree__Structure.html">SMB_Tree_Structure</a> * <a class="code" href="smblib-priv_8h.html#af9495575fd1f1b35acf15252d318194e">SMB_Tree_Handle</a>;
<a name="l00539"></a>00539 
<a name="l00540"></a><a class="code" href="smblib-priv_8h.html#a8ed80b420834cc48382bacaa818133b0">00540</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structSMB__Connect__Def.html">SMB_Connect_Def</a> * <a class="code" href="smblib-priv_8h.html#a8ed80b420834cc48382bacaa818133b0">SMB_Handle_Type</a>;
<a name="l00541"></a>00541 
<a name="l00542"></a>00542 <span class="keyword">struct </span><a class="code" href="structSMB__Connect__Def.html">SMB_Connect_Def</a> {
<a name="l00543"></a>00543 
<a name="l00544"></a><a class="code" href="structSMB__Connect__Def.html#a761e14c3c489176bc41218fbd8033408">00544</a>   SMB_Handle_Type <a class="code" href="structSMB__Connect__Def.html#ada3120bb2b3e357ed06fae14de9f5b5a">Next_Con</a>, <a class="code" href="structSMB__Connect__Def.html#a761e14c3c489176bc41218fbd8033408">Prev_Con</a>;          <span class="comment">/* Next and previous conn */</span>
<a name="l00545"></a><a class="code" href="structSMB__Connect__Def.html#ab3d65c1af924351bc518a37fa1105390">00545</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#ab3d65c1af924351bc518a37fa1105390">protocol</a>;                                <span class="comment">/* What is the protocol   */</span>
<a name="l00546"></a><a class="code" href="structSMB__Connect__Def.html#a1f59ea0ae30d3001bf097c14ef40366d">00546</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#a1f59ea0ae30d3001bf097c14ef40366d">prot_IDX</a>;                                <span class="comment">/* And what is the index  */</span>
<a name="l00547"></a><a class="code" href="structSMB__Connect__Def.html#a190f359e1466eca37183b80361d8d95c">00547</a>   <span class="keywordtype">void</span> *<a class="code" href="structSMB__Connect__Def.html#a190f359e1466eca37183b80361d8d95c">Trans_Connect</a>;                         <span class="comment">/* The connection         */</span>
<a name="l00548"></a>00548 
<a name="l00549"></a>00549   <span class="comment">/* All these strings should be malloc&#39;d */</span>
<a name="l00550"></a>00550 
<a name="l00551"></a><a class="code" href="structSMB__Connect__Def.html#aa925e886deaefb5783df6299489d257a">00551</a>   <span class="keywordtype">char</span> <a class="code" href="structSMB__Connect__Def.html#ab5024856c80e69eee13d2b2b561a7404">service</a>[80], <a class="code" href="structSMB__Connect__Def.html#aa925e886deaefb5783df6299489d257a">username</a>[80], <a class="code" href="structSMB__Connect__Def.html#a5fc32cfcc815b435a6fa55e0982b2361">password</a>[80], <a class="code" href="structSMB__Connect__Def.html#a5577d95e5610b1330e6accb73a789c6e">desthost</a>[80], <a class="code" href="structSMB__Connect__Def.html#ab1e4febccdafa49945bb8f40e8acfc50">sock_options</a>[80];
<a name="l00552"></a><a class="code" href="structSMB__Connect__Def.html#a858891aa97fd7bd23bb3b056c8a6433f">00552</a>   <span class="keywordtype">char</span> <a class="code" href="structSMB__Connect__Def.html#a36edab7e5d8026bf23de0860019ea6c6">address</a>[80], <a class="code" href="structSMB__Connect__Def.html#a858891aa97fd7bd23bb3b056c8a6433f">myname</a>[80];
<a name="l00553"></a>00553 
<a name="l00554"></a><a class="code" href="structSMB__Connect__Def.html#a010b92bd29b07621c715268d45153133">00554</a>   SMB_Tree_Handle <a class="code" href="structSMB__Connect__Def.html#a3ec7acccd66c5f83157b8cb92064d572">first_tree</a>, <a class="code" href="structSMB__Connect__Def.html#a010b92bd29b07621c715268d45153133">last_tree</a>;  <span class="comment">/* List of trees on this server */</span>
<a name="l00555"></a>00555 
<a name="l00556"></a><a class="code" href="structSMB__Connect__Def.html#a5bec6371b5af058a60a42c2c520a67c5">00556</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#a5bec6371b5af058a60a42c2c520a67c5">gid</a>;         <span class="comment">/* Group ID, do we need it?                      */</span>
<a name="l00557"></a><a class="code" href="structSMB__Connect__Def.html#a7ece1d87a17acd85ca5eaf5e80d3c471">00557</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#a7ece1d87a17acd85ca5eaf5e80d3c471">mid</a>;         <span class="comment">/* Multiplex ID? We might need one per con       */</span>
<a name="l00558"></a><a class="code" href="structSMB__Connect__Def.html#ac03b17403c98bf462d2d9be02055023c">00558</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#ac03b17403c98bf462d2d9be02055023c">pid</a>;         <span class="comment">/* Process ID                                    */</span>
<a name="l00559"></a>00559 
<a name="l00560"></a><a class="code" href="structSMB__Connect__Def.html#ae1da8a5a5e125abd0080d5b077d92eaa">00560</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#ae1da8a5a5e125abd0080d5b077d92eaa">uid</a>;         <span class="comment">/* Authenticated user id.                        */</span>
<a name="l00561"></a>00561 
<a name="l00562"></a>00562                    <span class="comment">/* It is pretty clear that we need to bust some of */</span>
<a name="l00563"></a>00563                    <span class="comment">/* these out into a per TCon record, as there may  */</span>
<a name="l00564"></a>00564                    <span class="comment">/* be multiple TCon&#39;s per server, etc ... later    */</span>
<a name="l00565"></a>00565 
<a name="l00566"></a><a class="code" href="structSMB__Connect__Def.html#ad0c506fa23859b4c2a090f695260f1be">00566</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#ad0c506fa23859b4c2a090f695260f1be">port</a>;        <span class="comment">/* port to use in case not default, this is a TCPism! */</span>
<a name="l00567"></a>00567 
<a name="l00568"></a><a class="code" href="structSMB__Connect__Def.html#afa81991012d495dd7533db1f7f06653b">00568</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#afa81991012d495dd7533db1f7f06653b">max_xmit</a>;    <span class="comment">/* Max xmit permitted by server                  */</span>
<a name="l00569"></a><a class="code" href="structSMB__Connect__Def.html#acb6e4c2ed268739735e47c77e55c3710">00569</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#acb6e4c2ed268739735e47c77e55c3710">Security</a>;    <span class="comment">/* 0 = share, 1 = user                           */</span>
<a name="l00570"></a><a class="code" href="structSMB__Connect__Def.html#aa17e0bdfb1385626b71a80a4e72db450">00570</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#aa17e0bdfb1385626b71a80a4e72db450">Raw_Support</a>; <span class="comment">/* bit 0 = 1 = Read Raw supported, 1 = 1 Write raw */</span>
<a name="l00571"></a><a class="code" href="structSMB__Connect__Def.html#acd34eeeffff9f8f4a726234d819a5e33">00571</a>   <a class="code" href="std-includes_8h.html#ae4cc35dcc70810fa972cc8a5185a28fa">BOOL</a> <a class="code" href="structSMB__Connect__Def.html#acd34eeeffff9f8f4a726234d819a5e33">encrypt_passwords</a>; <span class="comment">/* FALSE = don&#39;t                          */</span>
<a name="l00572"></a><a class="code" href="structSMB__Connect__Def.html#ac747c2526a3ad1aba60392bfa288194d">00572</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#a8dd3cc17d18ed0059710639df4fcc8a1">MaxMPX</a>, <a class="code" href="structSMB__Connect__Def.html#ac747c2526a3ad1aba60392bfa288194d">MaxVC</a>, <a class="code" href="structSMB__Connect__Def.html#a440894e8128a70ce9b89efc7e3fd0529">MaxRaw</a>;
<a name="l00573"></a><a class="code" href="structSMB__Connect__Def.html#ab8cfb4f6b74d09986fd23488914fc2a4">00573</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#ab8cfb4f6b74d09986fd23488914fc2a4">SessionKey</a>, <a class="code" href="structSMB__Connect__Def.html#a5f000777b0c21d073b697f04295c8833">Capabilities</a>;
<a name="l00574"></a><a class="code" href="structSMB__Connect__Def.html#a8bbde1933ceb5c0faf24cca7270947ea">00574</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#a8bbde1933ceb5c0faf24cca7270947ea">SvrTZ</a>;                                 <span class="comment">/* Server Time Zone */</span>
<a name="l00575"></a><a class="code" href="structSMB__Connect__Def.html#ac3691174ac4805e17982b5d287d1d479">00575</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Connect__Def.html#ac3691174ac4805e17982b5d287d1d479">Encrypt_Key_Len</a>;
<a name="l00576"></a><a class="code" href="structSMB__Connect__Def.html#aa9fe420137eb8632067296d2630f4f40">00576</a>   <span class="keywordtype">char</span> <a class="code" href="structSMB__Connect__Def.html#a405c25df1373ed7bb5fc6472ef1a026b">Encrypt_Key</a>[80], <a class="code" href="structSMB__Connect__Def.html#ae1e030203358b8cfb17b8ec30ffeb101">Domain</a>[80], <a class="code" href="structSMB__Connect__Def.html#aa9fe420137eb8632067296d2630f4f40">PDomain</a>[80], <a class="code" href="structSMB__Connect__Def.html#af55745ab360b0e4abbe4eb5ccb656710">OSName</a>[80], <a class="code" href="structSMB__Connect__Def.html#a6bf29761ed9a84d9cbc92eea8bc8d18b">LMType</a>[40];
<a name="l00577"></a><a class="code" href="structSMB__Connect__Def.html#ae4b354e2ae58edc746990e62ef3a9a23">00577</a>   <span class="keywordtype">char</span> <a class="code" href="structSMB__Connect__Def.html#a7e019786c42c08eeccab8a4979ac2a32">Svr_OS</a>[80], <a class="code" href="structSMB__Connect__Def.html#a790afaa516003f088a66d88e5550ff50">Svr_LMType</a>[80], <a class="code" href="structSMB__Connect__Def.html#ae4b354e2ae58edc746990e62ef3a9a23">Svr_PDom</a>[80];
<a name="l00578"></a>00578 
<a name="l00579"></a>00579 };
<a name="l00580"></a>00580 
<a name="l00581"></a><a class="code" href="smblib-priv_8h.html#a3f6cd7d116545f0cf17d467c7f1eb6da">00581</a> <span class="preprocessor">#define SMBLIB_DEFAULT_DOMAIN &quot;STAFF&quot;</span>
<a name="l00582"></a><a class="code" href="smblib-priv_8h.html#a3618798f254f71064e0a6f9d50e47fe7">00582</a> <span class="preprocessor"></span><span class="preprocessor">#define SMBLIB_DEFAULT_OSNAME &quot;UNIX of some type&quot;</span>
<a name="l00583"></a><a class="code" href="smblib-priv_8h.html#a7f2215d87d974037ea44a928b86dbd9a">00583</a> <span class="preprocessor"></span><span class="preprocessor">#define SMBLIB_DEFAULT_LMTYPE &quot;SMBlib LM2.1 minus a bit&quot;</span>
<a name="l00584"></a><a class="code" href="smblib-priv_8h.html#a3893f095d02978712a6e8e501be30652">00584</a> <span class="preprocessor"></span><span class="preprocessor">#define SMBLIB_MAX_XMIT 65535</span>
<a name="l00585"></a>00585 <span class="preprocessor"></span>
<a name="l00586"></a><a class="code" href="smblib-priv_8h.html#ae9d99796f1425b7dceb843f25d118544">00586</a> <span class="preprocessor">#define SMB_Sec_Mode_Share 0</span>
<a name="l00587"></a><a class="code" href="smblib-priv_8h.html#a5c6412f07c82be5fd85c968439fdb9d8">00587</a> <span class="preprocessor"></span><span class="preprocessor">#define SMB_Sec_Mode_User  1</span>
<a name="l00588"></a>00588 <span class="preprocessor"></span>
<a name="l00589"></a>00589 <span class="comment">/* A Tree_Structure                       */</span>
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 <span class="keyword">struct </span><a class="code" href="structSMB__Tree__Structure.html">SMB_Tree_Structure</a> {
<a name="l00592"></a>00592 
<a name="l00593"></a><a class="code" href="structSMB__Tree__Structure.html#af66fb7553235ec0ec7907685a96561e3">00593</a>   SMB_Tree_Handle <a class="code" href="structSMB__Tree__Structure.html#a5e2427c84fe5b231ef43951cc194d9ac">next</a>, <a class="code" href="structSMB__Tree__Structure.html#af66fb7553235ec0ec7907685a96561e3">prev</a>;
<a name="l00594"></a><a class="code" href="structSMB__Tree__Structure.html#aaba16039ad45436b3764bdc375117a63">00594</a>   SMB_Handle_Type <a class="code" href="structSMB__Tree__Structure.html#aaba16039ad45436b3764bdc375117a63">con</a>;
<a name="l00595"></a><a class="code" href="structSMB__Tree__Structure.html#af188d3a1c5beb51b95e22602072dde3e">00595</a>   <span class="keywordtype">char</span> <a class="code" href="structSMB__Tree__Structure.html#af188d3a1c5beb51b95e22602072dde3e">path</a>[129];
<a name="l00596"></a><a class="code" href="structSMB__Tree__Structure.html#a6b475ae4f35224eb597ee8e02f5ecbc1">00596</a>   <span class="keywordtype">char</span> <a class="code" href="structSMB__Tree__Structure.html#a6b475ae4f35224eb597ee8e02f5ecbc1">device_type</a>[20];
<a name="l00597"></a><a class="code" href="structSMB__Tree__Structure.html#a6e264df31af1b7b7dcd6023d1ff41a47">00597</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Tree__Structure.html#a6e264df31af1b7b7dcd6023d1ff41a47">mbs</a>;                   <span class="comment">/* Local MBS */</span>
<a name="l00598"></a><a class="code" href="structSMB__Tree__Structure.html#ac490e3d172019c5fc0947b75743fdd94">00598</a>   <span class="keywordtype">int</span> <a class="code" href="structSMB__Tree__Structure.html#ac490e3d172019c5fc0947b75743fdd94">tid</a>;
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 };
<a name="l00601"></a>00601 
<a name="l00602"></a><a class="code" href="smblib-priv_8h.html#ae81b0c75f74c0f05bc8f8e28cdd3a4e4">00602</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structSMB__File__Def.html">SMB_File_Def</a> <a class="code" href="structSMB__File__Def.html">SMB_File</a>;
<a name="l00603"></a>00603 
<a name="l00604"></a>00604 <span class="keyword">struct </span><a class="code" href="structSMB__File__Def.html">SMB_File_Def</a> {
<a name="l00605"></a>00605 
<a name="l00606"></a><a class="code" href="structSMB__File__Def.html#a29a56de89f2c367eea0d0dbffa2ff6a5">00606</a>   SMB_Tree_Handle <a class="code" href="structSMB__File__Def.html#a29a56de89f2c367eea0d0dbffa2ff6a5">tree</a>;
<a name="l00607"></a><a class="code" href="structSMB__File__Def.html#a35e036ab061d7036dac714e00e892fa3">00607</a>   <span class="keywordtype">char</span> <a class="code" href="structSMB__File__Def.html#a35e036ab061d7036dac714e00e892fa3">filename</a>[256];          <span class="comment">/* We should malloc this ... */</span>
<a name="l00608"></a><a class="code" href="structSMB__File__Def.html#ac04ad90b90f3869bd7c028d05a5662f5">00608</a>   UWORD <a class="code" href="structSMB__File__Def.html#ac04ad90b90f3869bd7c028d05a5662f5">fid</a>;
<a name="l00609"></a><a class="code" href="structSMB__File__Def.html#a0097240bd16785d936719f2a0e5fabc5">00609</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structSMB__File__Def.html#a0097240bd16785d936719f2a0e5fabc5">lastmod</a>;
<a name="l00610"></a><a class="code" href="structSMB__File__Def.html#a67273b8a5479f85699d235ffeb7d4700">00610</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structSMB__File__Def.html#a67273b8a5479f85699d235ffeb7d4700">size</a>;           <span class="comment">/* Could blow up if 64bit files supported */</span>
<a name="l00611"></a><a class="code" href="structSMB__File__Def.html#afce72e05baf1fe168feddd25ab145c9d">00611</a>   UWORD <a class="code" href="structSMB__File__Def.html#afce72e05baf1fe168feddd25ab145c9d">access</a>;
<a name="l00612"></a><a class="code" href="structSMB__File__Def.html#a50765afc99b3f73eb111c93f3f558d80">00612</a>   off_t <a class="code" href="structSMB__File__Def.html#a50765afc99b3f73eb111c93f3f558d80">fileloc</a>;
<a name="l00613"></a>00613 
<a name="l00614"></a>00614 };
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 <span class="comment">/* global Variables for the library */</span>
<a name="l00617"></a>00617 
<a name="l00618"></a>00618 <span class="keyword">extern</span> <a class="code" href="smblib-priv_8h.html#a083cd02bbb9055ea7cadce84fb96e88d">SMB_State_Types</a> <a class="code" href="smblib-priv_8h.html#ab9718837584f69568038b8a6c82c8626">SMBlib_State</a>;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620 <span class="preprocessor">#ifndef SMBLIB_ERRNO</span>
<a name="l00621"></a>00621 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="smblib-priv_8h.html#a3e289afa6a848f745df1a82f3346a02e">SMBlib_errno</a>;
<a name="l00622"></a>00622 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="smblib-priv_8h.html#a7dfefe852d02abefa92660786d39980c">SMBlib_SMB_Error</a>;          <span class="comment">/* last Error             */</span>
<a name="l00623"></a>00623 <span class="preprocessor">#endif</span>
<a name="l00624"></a>00624 <span class="preprocessor"></span>
<a name="l00625"></a>00625 SMB_Tree_Handle <a class="code" href="smblib-priv_8h.html#aeeb6b6aba93c01dfa56c50c8f238f5c4">SMB_TreeConnect</a>(SMB_Handle_Type con, SMB_Tree_Handle tree,
<a name="l00626"></a>00626                                 <span class="keywordtype">char</span> *path, <span class="keywordtype">char</span> *<a class="code" href="radeapclient_8c.html#a3297dde3b98c18f303a0294685bc0b79">password</a>, <span class="keywordtype">char</span> *dev);
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 5 2012 16:31:04 for FreeRADIUS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5
</small></address>

</body>
</html>
